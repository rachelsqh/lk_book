<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="1861pt" height="2896pt"
 viewBox="0.00 0.00 1861.00 2896.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2892)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2892 1857,-2892 1857,4 -4,4"/>
<text text-anchor="middle" x="926.5" y="-7.8" font-family="Times,serif" font-size="14.00">linux vfs</text>
<g id="clust1" class="cluster">
<title>cluster_0</title>
<polygon fill="none" stroke="black" points="33.5,-31 33.5,-324 461.5,-324 461.5,-31 33.5,-31"/>
<text text-anchor="middle" x="247.5" y="-308.8" font-family="Times,serif" font-size="14.00">struct fs_context</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_1</title>
<polygon fill="none" stroke="black" points="8,-332 8,-2880 1845,-2880 1845,-332 8,-332"/>
<text text-anchor="middle" x="926.5" y="-2864.8" font-family="Times,serif" font-size="14.00">VFS</text>
</g>
<!-- fsc -->
<g id="node1" class="node">
<title>fsc</title>
<polygon fill="none" stroke="black" points="41.5,-39.5 41.5,-292.5 453.5,-292.5 453.5,-39.5 41.5,-39.5"/>
<text text-anchor="middle" x="247.5" y="-277.3" font-family="Times,serif" font-size="14.00">struct fs_context {</text>
<polyline fill="none" stroke="black" points="41.5,-269.5 453.5,-269.5 "/>
<text text-anchor="middle" x="247.5" y="-254.3" font-family="Times,serif" font-size="14.00">const struct fs_context_operations *ops;</text>
<polyline fill="none" stroke="black" points="41.5,-246.5 453.5,-246.5 "/>
<text text-anchor="middle" x="247.5" y="-231.3" font-family="Times,serif" font-size="14.00">struct file_system_type*fs_type;</text>
<polyline fill="none" stroke="black" points="41.5,-223.5 453.5,-223.5 "/>
<text text-anchor="middle" x="247.5" y="-208.3" font-family="Times,serif" font-size="14.00">struct dentry*root;/* The root and superblock */</text>
<polyline fill="none" stroke="black" points="41.5,-200.5 453.5,-200.5 "/>
<text text-anchor="middle" x="247.5" y="-185.3" font-family="Times,serif" font-size="14.00">struct user_namespace*user_ns;/* The user namespace for this mount */</text>
<polyline fill="none" stroke="black" points="41.5,-177.5 453.5,-177.5 "/>
<text text-anchor="middle" x="247.5" y="-162.3" font-family="Times,serif" font-size="14.00">struct net*net_ns;/* The network namespace for this mount */</text>
<polyline fill="none" stroke="black" points="41.5,-154.5 453.5,-154.5 "/>
<text text-anchor="middle" x="247.5" y="-139.3" font-family="Times,serif" font-size="14.00">const struct cred*cred;/* The mounter&#39;s credentials */</text>
<polyline fill="none" stroke="black" points="41.5,-131.5 453.5,-131.5 "/>
<text text-anchor="middle" x="247.5" y="-116.3" font-family="Times,serif" font-size="14.00">struct p_loglog;/* Logging buffer */</text>
<polyline fill="none" stroke="black" points="41.5,-108.5 453.5,-108.5 "/>
<text text-anchor="middle" x="247.5" y="-93.3" font-family="Times,serif" font-size="14.00">const char*source;/* The source name (eg. dev path) */</text>
<polyline fill="none" stroke="black" points="41.5,-85.5 453.5,-85.5 "/>
<text text-anchor="middle" x="247.5" y="-70.3" font-family="Times,serif" font-size="14.00">...</text>
<polyline fill="none" stroke="black" points="41.5,-62.5 453.5,-62.5 "/>
<text text-anchor="middle" x="247.5" y="-47.3" font-family="Times,serif" font-size="14.00">}</text>
</g>
<!-- file_system_type -->
<g id="node2" class="node">
<title>file_system_type</title>
<polygon fill="none" stroke="black" points="89,-2557.5 89,-2848.5 406,-2848.5 406,-2557.5 89,-2557.5"/>
<text text-anchor="middle" x="247.5" y="-2833.3" font-family="Times,serif" font-size="14.00">struct file_system_type{</text>
<polyline fill="none" stroke="black" points="89,-2825.5 406,-2825.5 "/>
<text text-anchor="middle" x="247.5" y="-2810.3" font-family="Times,serif" font-size="14.00">const char *name;</text>
<polyline fill="none" stroke="black" points="89,-2802.5 406,-2802.5 "/>
<text text-anchor="middle" x="247.5" y="-2787.3" font-family="Times,serif" font-size="14.00">int fs_flags;</text>
<polyline fill="none" stroke="black" points="89,-2779.5 406,-2779.5 "/>
<text text-anchor="middle" x="247.5" y="-2764.3" font-family="Times,serif" font-size="14.00">int (*init_fs_context)(struct fs_context *);</text>
<polyline fill="none" stroke="black" points="89,-2756.5 406,-2756.5 "/>
<text text-anchor="middle" x="247.5" y="-2741.3" font-family="Times,serif" font-size="14.00">const struct fs_parameter_spec *parameters;</text>
<polyline fill="none" stroke="black" points="89,-2733.5 406,-2733.5 "/>
<text text-anchor="middle" x="247.5" y="-2718.3" font-family="Times,serif" font-size="14.00">struct dentry *(*mount) (struct file_system_type *, int,</text>
<text text-anchor="middle" x="247.5" y="-2703.3" font-family="Times,serif" font-size="14.00">const char *, void *);</text>
<polyline fill="none" stroke="black" points="89,-2695.5 406,-2695.5 "/>
<text text-anchor="middle" x="247.5" y="-2680.3" font-family="Times,serif" font-size="14.00">void (*kill_sb) (struct super_block *);</text>
<polyline fill="none" stroke="black" points="89,-2672.5 406,-2672.5 "/>
<text text-anchor="middle" x="247.5" y="-2657.3" font-family="Times,serif" font-size="14.00">struct module *owner;</text>
<polyline fill="none" stroke="black" points="89,-2649.5 406,-2649.5 "/>
<text text-anchor="middle" x="247.5" y="-2634.3" font-family="Times,serif" font-size="14.00">struct file_system_type * next;</text>
<polyline fill="none" stroke="black" points="89,-2626.5 406,-2626.5 "/>
<text text-anchor="middle" x="247.5" y="-2611.3" font-family="Times,serif" font-size="14.00">struct hlist_head fs_supers;</text>
<polyline fill="none" stroke="black" points="89,-2603.5 406,-2603.5 "/>
<text text-anchor="middle" x="247.5" y="-2588.3" font-family="Times,serif" font-size="14.00">...</text>
<polyline fill="none" stroke="black" points="89,-2580.5 406,-2580.5 "/>
<text text-anchor="middle" x="247.5" y="-2565.3" font-family="Times,serif" font-size="14.00">}</text>
</g>
<!-- super_block -->
<g id="node3" class="node">
<title>super_block</title>
<polygon fill="none" stroke="black" points="1446,-2721.5 1446,-2790.5 1837,-2790.5 1837,-2721.5 1446,-2721.5"/>
<text text-anchor="middle" x="1641.5" y="-2775.3" font-family="Times,serif" font-size="14.00">struct super_block {//以链表形式组织一个文件系统的所有资源</text>
<polyline fill="none" stroke="black" points="1446,-2767.5 1837,-2767.5 "/>
<text text-anchor="middle" x="1641.5" y="-2752.3" font-family="Times,serif" font-size="14.00">...</text>
<polyline fill="none" stroke="black" points="1446,-2744.5 1837,-2744.5 "/>
<text text-anchor="middle" x="1641.5" y="-2729.3" font-family="Times,serif" font-size="14.00">};</text>
</g>
<!-- dentry -->
<g id="node4" class="node">
<title>dentry</title>
<polygon fill="none" stroke="black" points="937,-2045.5 937,-2678.5 1410,-2678.5 1410,-2045.5 937,-2045.5"/>
<text text-anchor="middle" x="1173.5" y="-2663.3" font-family="Times,serif" font-size="14.00">struct dentry {</text>
<polyline fill="none" stroke="black" points="937,-2655.5 1410,-2655.5 "/>
<text text-anchor="middle" x="1173.5" y="-2640.3" font-family="Times,serif" font-size="14.00">/* RCU lookup touched fields */</text>
<polyline fill="none" stroke="black" points="937,-2632.5 1410,-2632.5 "/>
<text text-anchor="middle" x="1173.5" y="-2617.3" font-family="Times,serif" font-size="14.00">unsigned int d_flags;/* protected by d_lock */</text>
<polyline fill="none" stroke="black" points="937,-2609.5 1410,-2609.5 "/>
<text text-anchor="middle" x="1173.5" y="-2594.3" font-family="Times,serif" font-size="14.00">seqcount_spinlock_t d_seq;/* per dentry seqlock */</text>
<polyline fill="none" stroke="black" points="937,-2586.5 1410,-2586.5 "/>
<text text-anchor="middle" x="1173.5" y="-2571.3" font-family="Times,serif" font-size="14.00">struct hlist_bl_node d_hash;/* lookup hash list */</text>
<polyline fill="none" stroke="black" points="937,-2563.5 1410,-2563.5 "/>
<text text-anchor="middle" x="1173.5" y="-2548.3" font-family="Times,serif" font-size="14.00">struct dentry *d_parent;</text>
<text text-anchor="middle" x="1173.5" y="-2533.3" font-family="Times,serif" font-size="14.00">/* parent directory:这个就是获取绝对地址的依据，可参考getcwd系统调用 */</text>
<polyline fill="none" stroke="black" points="937,-2525.5 1410,-2525.5 "/>
<text text-anchor="middle" x="1173.5" y="-2510.3" font-family="Times,serif" font-size="14.00">struct qstr d_name;</text>
<polyline fill="none" stroke="black" points="937,-2502.5 1410,-2502.5 "/>
<text text-anchor="middle" x="1173.5" y="-2487.3" font-family="Times,serif" font-size="14.00">struct inode *d_inode;/* Where the name belongs to &#45; NULL is negative */</text>
<polyline fill="none" stroke="black" points="937,-2479.5 1410,-2479.5 "/>
<text text-anchor="middle" x="1173.5" y="-2464.3" font-family="Times,serif" font-size="14.00">unsigned char d_iname[DNAME_INLINE_LEN];/* small names */</text>
<polyline fill="none" stroke="black" points="937,-2456.5 1410,-2456.5 "/>
<text text-anchor="middle" x="1173.5" y="-2441.3" font-family="Times,serif" font-size="14.00">/* Ref lookup also touches following */</text>
<polyline fill="none" stroke="black" points="937,-2433.5 1410,-2433.5 "/>
<text text-anchor="middle" x="1173.5" y="-2418.3" font-family="Times,serif" font-size="14.00">struct lockref d_lockref;/* per&#45;dentry lock and refcount */</text>
<polyline fill="none" stroke="black" points="937,-2410.5 1410,-2410.5 "/>
<text text-anchor="middle" x="1173.5" y="-2395.3" font-family="Times,serif" font-size="14.00">const struct dentry_operations *d_op;</text>
<polyline fill="none" stroke="black" points="937,-2387.5 1410,-2387.5 "/>
<text text-anchor="middle" x="1173.5" y="-2372.3" font-family="Times,serif" font-size="14.00">struct super_block *d_sb;/* The root of the dentry tree */</text>
<polyline fill="none" stroke="black" points="937,-2364.5 1410,-2364.5 "/>
<text text-anchor="middle" x="1173.5" y="-2349.3" font-family="Times,serif" font-size="14.00">unsigned long d_time;/* used by d_revalidate */</text>
<polyline fill="none" stroke="black" points="937,-2341.5 1410,-2341.5 "/>
<text text-anchor="middle" x="1173.5" y="-2326.3" font-family="Times,serif" font-size="14.00">void *d_fsdata;/* fs&#45;specific data */</text>
<polyline fill="none" stroke="black" points="937,-2318.5 1410,-2318.5 "/>
<text text-anchor="middle" x="1173.5" y="-2303.3" font-family="Times,serif" font-size="14.00">union {</text>
<text text-anchor="middle" x="1173.5" y="-2288.3" font-family="Times,serif" font-size="14.00">struct list_head d_lru;</text>
<text text-anchor="middle" x="1173.5" y="-2273.3" font-family="Times,serif" font-size="14.00">/* LRU list */</text>
<text text-anchor="middle" x="1173.5" y="-2258.3" font-family="Times,serif" font-size="14.00">wait_queue_head_t *d_wait;</text>
<text text-anchor="middle" x="1173.5" y="-2243.3" font-family="Times,serif" font-size="14.00">/* in&#45;lookup ones only */</text>
<text text-anchor="middle" x="1173.5" y="-2228.3" font-family="Times,serif" font-size="14.00">};</text>
<polyline fill="none" stroke="black" points="937,-2220.5 1410,-2220.5 "/>
<text text-anchor="middle" x="1173.5" y="-2205.3" font-family="Times,serif" font-size="14.00">struct list_head d_child;/* child of parent list */</text>
<polyline fill="none" stroke="black" points="937,-2197.5 1410,-2197.5 "/>
<text text-anchor="middle" x="1173.5" y="-2182.3" font-family="Times,serif" font-size="14.00">struct list_head d_subdirs;/* our children */</text>
<polyline fill="none" stroke="black" points="937,-2174.5 1410,-2174.5 "/>
<text text-anchor="middle" x="1173.5" y="-2159.3" font-family="Times,serif" font-size="14.00">/* d_alias and d_rcu can share memory */</text>
<polyline fill="none" stroke="black" points="937,-2151.5 1410,-2151.5 "/>
<text text-anchor="middle" x="1173.5" y="-2136.3" font-family="Times,serif" font-size="14.00">union {</text>
<text text-anchor="middle" x="1173.5" y="-2121.3" font-family="Times,serif" font-size="14.00">struct hlist_node d_alias;/* inode alias list */</text>
<text text-anchor="middle" x="1173.5" y="-2106.3" font-family="Times,serif" font-size="14.00">struct hlist_bl_node d_in_lookup_hash;/* only for in&#45;lookup ones */</text>
<text text-anchor="middle" x="1173.5" y="-2091.3" font-family="Times,serif" font-size="14.00">struct rcu_head d_rcu;</text>
<text text-anchor="middle" x="1173.5" y="-2076.3" font-family="Times,serif" font-size="14.00">} d_u;</text>
<polyline fill="none" stroke="black" points="937,-2068.5 1410,-2068.5 "/>
<text text-anchor="middle" x="1173.5" y="-2053.3" font-family="Times,serif" font-size="14.00">}</text>
</g>
<!-- vfsmount -->
<g id="node5" class="node">
<title>vfsmount</title>
<polygon fill="none" stroke="black" points="1016,-2698 1016,-2836 1331,-2836 1331,-2698 1016,-2698"/>
<text text-anchor="middle" x="1173.5" y="-2820.8" font-family="Times,serif" font-size="14.00">struct vfsmount {</text>
<polyline fill="none" stroke="black" points="1016,-2813 1331,-2813 "/>
<text text-anchor="middle" x="1173.5" y="-2797.8" font-family="Times,serif" font-size="14.00">struct dentry *mnt_root;/* root of the mounted tree */</text>
<polyline fill="none" stroke="black" points="1016,-2790 1331,-2790 "/>
<text text-anchor="middle" x="1173.5" y="-2774.8" font-family="Times,serif" font-size="14.00">struct super_block *mnt_sb;/* pointer to superblock */</text>
<polyline fill="none" stroke="black" points="1016,-2767 1331,-2767 "/>
<text text-anchor="middle" x="1173.5" y="-2751.8" font-family="Times,serif" font-size="14.00">int mnt_flags;</text>
<polyline fill="none" stroke="black" points="1016,-2744 1331,-2744 "/>
<text text-anchor="middle" x="1173.5" y="-2728.8" font-family="Times,serif" font-size="14.00">struct user_namespace *mnt_userns;</text>
<polyline fill="none" stroke="black" points="1016,-2721 1331,-2721 "/>
<text text-anchor="middle" x="1173.5" y="-2705.8" font-family="Times,serif" font-size="14.00">}</text>
</g>
<!-- vfsmount&#45;&gt;super_block -->
<g id="edge1" class="edge">
<title>vfsmount:f2&#45;&gt;super_block:f0</title>
<path fill="none" stroke="black" d="M1332.5,-2779C1379.4,-2779 1393.6,-2779 1435.89,-2779"/>
<polygon fill="black" stroke="black" points="1436,-2782.5 1446,-2779 1436,-2775.5 1436,-2782.5"/>
</g>
<!-- path -->
<g id="node6" class="node">
<title>path</title>
<polygon fill="none" stroke="black" points="632,-2756 632,-2848 784,-2848 784,-2756 632,-2756"/>
<text text-anchor="middle" x="708" y="-2832.8" font-family="Times,serif" font-size="14.00">struct path { //文件路径</text>
<polyline fill="none" stroke="black" points="632,-2825 784,-2825 "/>
<text text-anchor="middle" x="708" y="-2809.8" font-family="Times,serif" font-size="14.00">struct vfsmount *mnt;</text>
<polyline fill="none" stroke="black" points="632,-2802 784,-2802 "/>
<text text-anchor="middle" x="708" y="-2786.8" font-family="Times,serif" font-size="14.00">struct dentry *dentry;</text>
<polyline fill="none" stroke="black" points="632,-2779 784,-2779 "/>
<text text-anchor="middle" x="708" y="-2763.8" font-family="Times,serif" font-size="14.00">}</text>
</g>
<!-- path&#45;&gt;dentry -->
<g id="edge3" class="edge">
<title>path:f2&#45;&gt;dentry:f0</title>
<path fill="none" stroke="black" d="M785,-2790C839.98,-2790 860.82,-2784.54 901,-2747 926.48,-2723.19 903.98,-2677.96 926.86,-2668.69"/>
<polygon fill="black" stroke="black" points="927.71,-2672.09 937,-2667 926.56,-2665.19 927.71,-2672.09"/>
</g>
<!-- path&#45;&gt;vfsmount -->
<g id="edge2" class="edge">
<title>path:f1&#45;&gt;vfsmount:f0</title>
<path fill="none" stroke="black" d="M785,-2814C883.63,-2814 910.57,-2824.26 1004.29,-2824.96"/>
<polygon fill="black" stroke="black" points="1004.49,-2828.46 1014.5,-2825 1004.51,-2821.46 1004.49,-2828.46"/>
</g>
<!-- inode -->
<g id="node7" class="node">
<title>inode</title>
<polygon fill="none" stroke="black" points="545,-991 545,-2737 871,-2737 871,-991 545,-991"/>
<text text-anchor="middle" x="708" y="-2721.8" font-family="Times,serif" font-size="14.00">struct inode {</text>
<polyline fill="none" stroke="black" points="545,-2714 871,-2714 "/>
<text text-anchor="middle" x="708" y="-2698.8" font-family="Times,serif" font-size="14.00">umode_ti_mode;</text>
<polyline fill="none" stroke="black" points="545,-2691 871,-2691 "/>
<text text-anchor="middle" x="708" y="-2675.8" font-family="Times,serif" font-size="14.00">unsigned shorti_opflags;</text>
<polyline fill="none" stroke="black" points="545,-2668 871,-2668 "/>
<text text-anchor="middle" x="708" y="-2652.8" font-family="Times,serif" font-size="14.00">kuid_ti_uid;</text>
<polyline fill="none" stroke="black" points="545,-2645 871,-2645 "/>
<text text-anchor="middle" x="708" y="-2629.8" font-family="Times,serif" font-size="14.00">kgid_ti_gid;</text>
<polyline fill="none" stroke="black" points="545,-2622 871,-2622 "/>
<text text-anchor="middle" x="708" y="-2606.8" font-family="Times,serif" font-size="14.00">unsigned inti_flags;</text>
<polyline fill="none" stroke="black" points="545,-2599 871,-2599 "/>
<text text-anchor="middle" x="708" y="-2583.8" font-family="Times,serif" font-size="14.00">struct posix_acl*i_acl;</text>
<polyline fill="none" stroke="black" points="545,-2576 871,-2576 "/>
<text text-anchor="middle" x="708" y="-2560.8" font-family="Times,serif" font-size="14.00">struct posix_acl*i_default_acl;</text>
<polyline fill="none" stroke="black" points="545,-2553 871,-2553 "/>
<text text-anchor="middle" x="708" y="-2537.8" font-family="Times,serif" font-size="14.00">const struct inode_operations*i_op;</text>
<polyline fill="none" stroke="black" points="545,-2530 871,-2530 "/>
<text text-anchor="middle" x="708" y="-2514.8" font-family="Times,serif" font-size="14.00">struct super_block*i_sb;</text>
<polyline fill="none" stroke="black" points="545,-2507 871,-2507 "/>
<text text-anchor="middle" x="708" y="-2491.8" font-family="Times,serif" font-size="14.00">struct address_space*i_mapping;</text>
<polyline fill="none" stroke="black" points="545,-2484 871,-2484 "/>
<text text-anchor="middle" x="708" y="-2468.8" font-family="Times,serif" font-size="14.00">void*i_security;</text>
<polyline fill="none" stroke="black" points="545,-2461 871,-2461 "/>
<text text-anchor="middle" x="708" y="-2445.8" font-family="Times,serif" font-size="14.00">unsigned longi_ino;</text>
<text text-anchor="middle" x="708" y="-2430.8" font-family="Times,serif" font-size="14.00">/* Stat data, not accessed from path walking */</text>
<polyline fill="none" stroke="black" points="545,-2423 871,-2423 "/>
<text text-anchor="middle" x="708" y="-2407.8" font-family="Times,serif" font-size="14.00">union {</text>
<text text-anchor="middle" x="708" y="-2392.8" font-family="Times,serif" font-size="14.00">const unsigned int i_nlink;</text>
<text text-anchor="middle" x="708" y="-2377.8" font-family="Times,serif" font-size="14.00">unsigned int __i_nlink;</text>
<text text-anchor="middle" x="708" y="-2362.8" font-family="Times,serif" font-size="14.00">};</text>
<text text-anchor="middle" x="708" y="-2347.8" font-family="Times,serif" font-size="14.00">//Filesystems may only read i_nlink directly. </text>
<text text-anchor="middle" x="708" y="-2332.8" font-family="Times,serif" font-size="14.00">They shall use the following functions for modification:</text>
<text text-anchor="middle" x="708" y="-2317.8" font-family="Times,serif" font-size="14.00"> (set|clear|inc|drop)_nlink </text>
<text text-anchor="middle" x="708" y="-2302.8" font-family="Times,serif" font-size="14.00"> inode_(inc|dec)_link_count</text>
<polyline fill="none" stroke="black" points="545,-2295 871,-2295 "/>
<text text-anchor="middle" x="708" y="-2279.8" font-family="Times,serif" font-size="14.00">dev_ti_rdev;//设备编号</text>
<polyline fill="none" stroke="black" points="545,-2272 871,-2272 "/>
<text text-anchor="middle" x="708" y="-2256.8" font-family="Times,serif" font-size="14.00">loff_ti_size;</text>
<polyline fill="none" stroke="black" points="545,-2249 871,-2249 "/>
<text text-anchor="middle" x="708" y="-2233.8" font-family="Times,serif" font-size="14.00">struct timespec64i_atime;</text>
<polyline fill="none" stroke="black" points="545,-2226 871,-2226 "/>
<text text-anchor="middle" x="708" y="-2210.8" font-family="Times,serif" font-size="14.00">struct timespec64i_mtime;</text>
<polyline fill="none" stroke="black" points="545,-2203 871,-2203 "/>
<text text-anchor="middle" x="708" y="-2187.8" font-family="Times,serif" font-size="14.00">struct timespec64i_ctime;</text>
<polyline fill="none" stroke="black" points="545,-2180 871,-2180 "/>
<text text-anchor="middle" x="708" y="-2164.8" font-family="Times,serif" font-size="14.00">spinlock_ti_lock;</text>
<text text-anchor="middle" x="708" y="-2149.8" font-family="Times,serif" font-size="14.00">/* i_blocks, i_bytes, maybe i_size */</text>
<polyline fill="none" stroke="black" points="545,-2142 871,-2142 "/>
<text text-anchor="middle" x="708" y="-2126.8" font-family="Times,serif" font-size="14.00">unsigned short i_bytes;</text>
<polyline fill="none" stroke="black" points="545,-2119 871,-2119 "/>
<text text-anchor="middle" x="708" y="-2103.8" font-family="Times,serif" font-size="14.00">u8i_blkbits;</text>
<polyline fill="none" stroke="black" points="545,-2096 871,-2096 "/>
<text text-anchor="middle" x="708" y="-2080.8" font-family="Times,serif" font-size="14.00">u8i_write_hint;</text>
<polyline fill="none" stroke="black" points="545,-2073 871,-2073 "/>
<text text-anchor="middle" x="708" y="-2057.8" font-family="Times,serif" font-size="14.00">blkcnt_ti_blocks;</text>
<polyline fill="none" stroke="black" points="545,-2050 871,-2050 "/>
<text text-anchor="middle" x="708" y="-2034.8" font-family="Times,serif" font-size="14.00">seqcount_ti_size_seqcount;</text>
<polyline fill="none" stroke="black" points="545,-2027 871,-2027 "/>
<text text-anchor="middle" x="708" y="-2011.8" font-family="Times,serif" font-size="14.00">unsigned longi_state;</text>
<polyline fill="none" stroke="black" points="545,-2004 871,-2004 "/>
<text text-anchor="middle" x="708" y="-1988.8" font-family="Times,serif" font-size="14.00">struct rw_semaphorei_rwsem;</text>
<polyline fill="none" stroke="black" points="545,-1981 871,-1981 "/>
<text text-anchor="middle" x="708" y="-1965.8" font-family="Times,serif" font-size="14.00">unsigned longdirtied_when;</text>
<text text-anchor="middle" x="708" y="-1950.8" font-family="Times,serif" font-size="14.00">//jiffies of first dirtying</text>
<polyline fill="none" stroke="black" points="545,-1943 871,-1943 "/>
<text text-anchor="middle" x="708" y="-1927.8" font-family="Times,serif" font-size="14.00">unsigned longdirtied_time_when;</text>
<polyline fill="none" stroke="black" points="545,-1920 871,-1920 "/>
<text text-anchor="middle" x="708" y="-1904.8" font-family="Times,serif" font-size="14.00">struct hlist_nodei_hash;</text>
<polyline fill="none" stroke="black" points="545,-1897 871,-1897 "/>
<text text-anchor="middle" x="708" y="-1881.8" font-family="Times,serif" font-size="14.00">struct list_headi_io_list;</text>
<text text-anchor="middle" x="708" y="-1866.8" font-family="Times,serif" font-size="14.00">/* backing dev IO list */</text>
<polyline fill="none" stroke="black" points="545,-1859 871,-1859 "/>
<text text-anchor="middle" x="708" y="-1843.8" font-family="Times,serif" font-size="14.00">struct bdi_writeback*i_wb;</text>
<text text-anchor="middle" x="708" y="-1828.8" font-family="Times,serif" font-size="14.00">/* the associated cgroup wb */</text>
<polyline fill="none" stroke="black" points="545,-1821 871,-1821 "/>
<text text-anchor="middle" x="708" y="-1805.8" font-family="Times,serif" font-size="14.00">inti_wb_frn_winner;</text>
<text text-anchor="middle" x="708" y="-1790.8" font-family="Times,serif" font-size="14.00">/* foreign inode detection, see wbc_detach_inode() */</text>
<polyline fill="none" stroke="black" points="545,-1783 871,-1783 "/>
<text text-anchor="middle" x="708" y="-1767.8" font-family="Times,serif" font-size="14.00">u16i_wb_frn_avg_time;</text>
<polyline fill="none" stroke="black" points="545,-1760 871,-1760 "/>
<text text-anchor="middle" x="708" y="-1744.8" font-family="Times,serif" font-size="14.00">u16i_wb_frn_history;</text>
<polyline fill="none" stroke="black" points="545,-1737 871,-1737 "/>
<text text-anchor="middle" x="708" y="-1721.8" font-family="Times,serif" font-size="14.00">struct list_headi_lru;</text>
<text text-anchor="middle" x="708" y="-1706.8" font-family="Times,serif" font-size="14.00">/* inode LRU list */</text>
<polyline fill="none" stroke="black" points="545,-1699 871,-1699 "/>
<text text-anchor="middle" x="708" y="-1683.8" font-family="Times,serif" font-size="14.00">struct list_headi_sb_list;</text>
<polyline fill="none" stroke="black" points="545,-1676 871,-1676 "/>
<text text-anchor="middle" x="708" y="-1660.8" font-family="Times,serif" font-size="14.00">struct list_headi_wb_list;</text>
<text text-anchor="middle" x="708" y="-1645.8" font-family="Times,serif" font-size="14.00">/* backing dev writeback list */</text>
<polyline fill="none" stroke="black" points="545,-1638 871,-1638 "/>
<text text-anchor="middle" x="708" y="-1622.8" font-family="Times,serif" font-size="14.00">union {</text>
<text text-anchor="middle" x="708" y="-1607.8" font-family="Times,serif" font-size="14.00">struct hlist_headi_dentry;</text>
<text text-anchor="middle" x="708" y="-1592.8" font-family="Times,serif" font-size="14.00">struct rcu_headi_rcu;</text>
<text text-anchor="middle" x="708" y="-1577.8" font-family="Times,serif" font-size="14.00">};</text>
<polyline fill="none" stroke="black" points="545,-1570 871,-1570 "/>
<text text-anchor="middle" x="708" y="-1554.8" font-family="Times,serif" font-size="14.00">atomic64_ti_version;</text>
<polyline fill="none" stroke="black" points="545,-1547 871,-1547 "/>
<text text-anchor="middle" x="708" y="-1531.8" font-family="Times,serif" font-size="14.00">atomic64_ti_sequence; </text>
<text text-anchor="middle" x="708" y="-1516.8" font-family="Times,serif" font-size="14.00">/* see futex */</text>
<polyline fill="none" stroke="black" points="545,-1509 871,-1509 "/>
<text text-anchor="middle" x="708" y="-1493.8" font-family="Times,serif" font-size="14.00">atomic_ti_count;</text>
<polyline fill="none" stroke="black" points="545,-1486 871,-1486 "/>
<text text-anchor="middle" x="708" y="-1470.8" font-family="Times,serif" font-size="14.00">atomic_ti_dio_count;</text>
<polyline fill="none" stroke="black" points="545,-1463 871,-1463 "/>
<text text-anchor="middle" x="708" y="-1447.8" font-family="Times,serif" font-size="14.00">atomic_ti_writecount;</text>
<polyline fill="none" stroke="black" points="545,-1440 871,-1440 "/>
<text text-anchor="middle" x="708" y="-1424.8" font-family="Times,serif" font-size="14.00">atomic_ti_readcount; </text>
<text text-anchor="middle" x="708" y="-1409.8" font-family="Times,serif" font-size="14.00">/* struct files open RO */</text>
<polyline fill="none" stroke="black" points="545,-1402 871,-1402 "/>
<text text-anchor="middle" x="708" y="-1386.8" font-family="Times,serif" font-size="14.00">union {</text>
<text text-anchor="middle" x="708" y="-1371.8" font-family="Times,serif" font-size="14.00"> const struct file_operations*i_fop;</text>
<text text-anchor="middle" x="708" y="-1356.8" font-family="Times,serif" font-size="14.00"> / * former &#45;&gt;i_op&#45;&gt;default_file_ops */</text>
<text text-anchor="middle" x="708" y="-1341.8" font-family="Times,serif" font-size="14.00">void (*free_inode)(struct inode *);};</text>
<polyline fill="none" stroke="black" points="545,-1334 871,-1334 "/>
<text text-anchor="middle" x="708" y="-1318.8" font-family="Times,serif" font-size="14.00">struct file_lock_context*i_flctx;</text>
<polyline fill="none" stroke="black" points="545,-1311 871,-1311 "/>
<text text-anchor="middle" x="708" y="-1295.8" font-family="Times,serif" font-size="14.00">struct address_spacei_data;</text>
<polyline fill="none" stroke="black" points="545,-1288 871,-1288 "/>
<text text-anchor="middle" x="708" y="-1272.8" font-family="Times,serif" font-size="14.00">struct list_headi_devices;</text>
<polyline fill="none" stroke="black" points="545,-1265 871,-1265 "/>
<text text-anchor="middle" x="708" y="-1249.8" font-family="Times,serif" font-size="14.00">union {</text>
<text text-anchor="middle" x="708" y="-1234.8" font-family="Times,serif" font-size="14.00">struct pipe_inode_info*i_pipe;</text>
<text text-anchor="middle" x="708" y="-1219.8" font-family="Times,serif" font-size="14.00">struct cdev*i_cdev;//对应字符设备</text>
<text text-anchor="middle" x="708" y="-1204.8" font-family="Times,serif" font-size="14.00">char*i_link;</text>
<text text-anchor="middle" x="708" y="-1189.8" font-family="Times,serif" font-size="14.00">unsignedi_dir_seq;};</text>
<polyline fill="none" stroke="black" points="545,-1182 871,-1182 "/>
<text text-anchor="middle" x="708" y="-1166.8" font-family="Times,serif" font-size="14.00">__u32i_generation;</text>
<polyline fill="none" stroke="black" points="545,-1159 871,-1159 "/>
<text text-anchor="middle" x="708" y="-1143.8" font-family="Times,serif" font-size="14.00">__u32i_fsnotify_mask; </text>
<text text-anchor="middle" x="708" y="-1128.8" font-family="Times,serif" font-size="14.00">/* all events this inode cares about */</text>
<polyline fill="none" stroke="black" points="545,-1121 871,-1121 "/>
<text text-anchor="middle" x="708" y="-1105.8" font-family="Times,serif" font-size="14.00">struct fsnotify_mark_connector __rcu*i_fsnotify_marks;</text>
<polyline fill="none" stroke="black" points="545,-1098 871,-1098 "/>
<text text-anchor="middle" x="708" y="-1082.8" font-family="Times,serif" font-size="14.00">truct fscrypt_info*i_crypt_info;</text>
<polyline fill="none" stroke="black" points="545,-1075 871,-1075 "/>
<text text-anchor="middle" x="708" y="-1059.8" font-family="Times,serif" font-size="14.00">struct fsverity_info*i_verity_info;</text>
<polyline fill="none" stroke="black" points="545,-1052 871,-1052 "/>
<text text-anchor="middle" x="708" y="-1036.8" font-family="Times,serif" font-size="14.00">void*i_private; </text>
<text text-anchor="middle" x="708" y="-1021.8" font-family="Times,serif" font-size="14.00">/* fs or device private pointer */</text>
<polyline fill="none" stroke="black" points="545,-1014 871,-1014 "/>
<text text-anchor="middle" x="708" y="-998.8" font-family="Times,serif" font-size="14.00">}</text>
</g>
<!-- file -->
<g id="node8" class="node">
<title>file</title>
<polygon fill="none" stroke="black" points="16,-1919.5 16,-2538.5 479,-2538.5 479,-1919.5 16,-1919.5"/>
<text text-anchor="middle" x="247.5" y="-2523.3" font-family="Times,serif" font-size="14.00">struct file {</text>
<polyline fill="none" stroke="black" points="16,-2515.5 479,-2515.5 "/>
<text text-anchor="middle" x="247.5" y="-2500.3" font-family="Times,serif" font-size="14.00">union {</text>
<text text-anchor="middle" x="247.5" y="-2485.3" font-family="Times,serif" font-size="14.00">struct llist_nodefu_llist;</text>
<text text-anchor="middle" x="247.5" y="-2470.3" font-family="Times,serif" font-size="14.00">struct rcu_head fu_rcuhead;</text>
<text text-anchor="middle" x="247.5" y="-2455.3" font-family="Times,serif" font-size="14.00">} f_u;</text>
<polyline fill="none" stroke="black" points="16,-2447.5 479,-2447.5 "/>
<text text-anchor="middle" x="247.5" y="-2432.3" font-family="Times,serif" font-size="14.00">struct pathf_path;</text>
<polyline fill="none" stroke="black" points="16,-2424.5 479,-2424.5 "/>
<text text-anchor="middle" x="247.5" y="-2409.3" font-family="Times,serif" font-size="14.00">struct inode*f_inode;</text>
<text text-anchor="middle" x="247.5" y="-2394.3" font-family="Times,serif" font-size="14.00">/* cached value */</text>
<polyline fill="none" stroke="black" points="16,-2386.5 479,-2386.5 "/>
<text text-anchor="middle" x="247.5" y="-2371.3" font-family="Times,serif" font-size="14.00">const struct file_operations*f_op;</text>
<polyline fill="none" stroke="black" points="16,-2363.5 479,-2363.5 "/>
<text text-anchor="middle" x="247.5" y="-2348.3" font-family="Times,serif" font-size="14.00">spinlock_tf_lock;</text>
<polyline fill="none" stroke="black" points="16,-2340.5 479,-2340.5 "/>
<text text-anchor="middle" x="247.5" y="-2325.3" font-family="Times,serif" font-size="14.00">enum rw_hintf_write_hint;</text>
<polyline fill="none" stroke="black" points="16,-2317.5 479,-2317.5 "/>
<text text-anchor="middle" x="247.5" y="-2302.3" font-family="Times,serif" font-size="14.00">atomic_long_tf_count;</text>
<polyline fill="none" stroke="black" points="16,-2294.5 479,-2294.5 "/>
<text text-anchor="middle" x="247.5" y="-2279.3" font-family="Times,serif" font-size="14.00">unsigned int f_flags;</text>
<polyline fill="none" stroke="black" points="16,-2271.5 479,-2271.5 "/>
<text text-anchor="middle" x="247.5" y="-2256.3" font-family="Times,serif" font-size="14.00">fmode_tf_mode;</text>
<polyline fill="none" stroke="black" points="16,-2248.5 479,-2248.5 "/>
<text text-anchor="middle" x="247.5" y="-2233.3" font-family="Times,serif" font-size="14.00">struct mutexf_pos_lock;</text>
<polyline fill="none" stroke="black" points="16,-2225.5 479,-2225.5 "/>
<text text-anchor="middle" x="247.5" y="-2210.3" font-family="Times,serif" font-size="14.00">loff_tf_pos;</text>
<polyline fill="none" stroke="black" points="16,-2202.5 479,-2202.5 "/>
<text text-anchor="middle" x="247.5" y="-2187.3" font-family="Times,serif" font-size="14.00">struct fown_structf_owner;</text>
<polyline fill="none" stroke="black" points="16,-2179.5 479,-2179.5 "/>
<text text-anchor="middle" x="247.5" y="-2164.3" font-family="Times,serif" font-size="14.00">const struct cred*f_cred;</text>
<polyline fill="none" stroke="black" points="16,-2156.5 479,-2156.5 "/>
<text text-anchor="middle" x="247.5" y="-2141.3" font-family="Times,serif" font-size="14.00">struct file_ra_statef_ra;</text>
<polyline fill="none" stroke="black" points="16,-2133.5 479,-2133.5 "/>
<text text-anchor="middle" x="247.5" y="-2118.3" font-family="Times,serif" font-size="14.00">u64f_version;</text>
<polyline fill="none" stroke="black" points="16,-2110.5 479,-2110.5 "/>
<text text-anchor="middle" x="247.5" y="-2095.3" font-family="Times,serif" font-size="14.00">void*f_security;</text>
<polyline fill="none" stroke="black" points="16,-2087.5 479,-2087.5 "/>
<text text-anchor="middle" x="247.5" y="-2072.3" font-family="Times,serif" font-size="14.00">void*private_data;</text>
<text text-anchor="middle" x="247.5" y="-2057.3" font-family="Times,serif" font-size="14.00">/* needed for tty driver, and maybe others */</text>
<polyline fill="none" stroke="black" points="16,-2049.5 479,-2049.5 "/>
<text text-anchor="middle" x="247.5" y="-2034.3" font-family="Times,serif" font-size="14.00">struct hlist_head*f_ep;/* Used by fs/eventpoll.c to link all the hooks to this file */</text>
<polyline fill="none" stroke="black" points="16,-2026.5 479,-2026.5 "/>
<text text-anchor="middle" x="247.5" y="-2011.3" font-family="Times,serif" font-size="14.00">struct address_space*f_mapping;</text>
<polyline fill="none" stroke="black" points="16,-2003.5 479,-2003.5 "/>
<text text-anchor="middle" x="247.5" y="-1988.3" font-family="Times,serif" font-size="14.00">errseq_tf_wb_err;</text>
<polyline fill="none" stroke="black" points="16,-1980.5 479,-1980.5 "/>
<text text-anchor="middle" x="247.5" y="-1965.3" font-family="Times,serif" font-size="14.00">errseq_tf_sb_err; </text>
<text text-anchor="middle" x="247.5" y="-1950.3" font-family="Times,serif" font-size="14.00">/* for syncfs */</text>
<polyline fill="none" stroke="black" points="16,-1942.5 479,-1942.5 "/>
<text text-anchor="middle" x="247.5" y="-1927.3" font-family="Times,serif" font-size="14.00">}</text>
</g>
<!-- file&#45;&gt;path -->
<g id="edge5" class="edge">
<title>file:f2&#45;&gt;path:f0</title>
<path fill="none" stroke="black" d="M479,-2436C548.57,-2436 480.85,-2686.39 515,-2747 545.28,-2800.74 563.66,-2833.3 620.7,-2836.7"/>
<polygon fill="black" stroke="black" points="620.9,-2840.21 631,-2837 621.1,-2833.21 620.9,-2840.21"/>
</g>
<!-- file&#45;&gt;inode -->
<g id="edge4" class="edge">
<title>file:f3&#45;&gt;inode:f0</title>
<path fill="none" stroke="black" d="M479,-2406C620.44,-2406 410.07,-2709.96 533.65,-2725.39"/>
<polygon fill="black" stroke="black" points="533.81,-2728.91 544,-2726 534.22,-2721.92 533.81,-2728.91"/>
</g>
<!-- address_space -->
<g id="node9" class="node">
<title>address_space</title>
<polygon fill="none" stroke="black" points="515,-340.5 515,-971.5 901,-971.5 901,-340.5 515,-340.5"/>
<text text-anchor="middle" x="708" y="-956.3" font-family="Times,serif" font-size="14.00">struct address_space {</text>
<text text-anchor="middle" x="708" y="-941.3" font-family="Times,serif" font-size="14.00"> // struct address_space &#45; Contents of a cacheable, mappable object.</text>
<polyline fill="none" stroke="black" points="515,-933.5 901,-933.5 "/>
<text text-anchor="middle" x="708" y="-918.3" font-family="Times,serif" font-size="14.00">struct inode*host;</text>
<text text-anchor="middle" x="708" y="-903.3" font-family="Times,serif" font-size="14.00">//Owner, either the inode or the block_device.</text>
<polyline fill="none" stroke="black" points="515,-895.5 901,-895.5 "/>
<text text-anchor="middle" x="708" y="-880.3" font-family="Times,serif" font-size="14.00">struct xarrayi_pages;</text>
<text text-anchor="middle" x="708" y="-865.3" font-family="Times,serif" font-size="14.00">// Cached pages.</text>
<polyline fill="none" stroke="black" points="515,-857.5 901,-857.5 "/>
<text text-anchor="middle" x="708" y="-842.3" font-family="Times,serif" font-size="14.00">gfp_tgfp_mask;</text>
<text text-anchor="middle" x="708" y="-827.3" font-family="Times,serif" font-size="14.00">//Memory allocation flags to use for allocating pages.</text>
<polyline fill="none" stroke="black" points="515,-819.5 901,-819.5 "/>
<text text-anchor="middle" x="708" y="-804.3" font-family="Times,serif" font-size="14.00">atomic_ti_mmap_writable;</text>
<text text-anchor="middle" x="708" y="-789.3" font-family="Times,serif" font-size="14.00">//Number of VM_SHARED mappings.</text>
<polyline fill="none" stroke="black" points="515,-781.5 901,-781.5 "/>
<text text-anchor="middle" x="708" y="-766.3" font-family="Times,serif" font-size="14.00">atomic_tnr_thps;</text>
<text text-anchor="middle" x="708" y="-751.3" font-family="Times,serif" font-size="14.00">//Number of THPs in the pagecache (non&#45;shmem only).</text>
<polyline fill="none" stroke="black" points="515,-743.5 901,-743.5 "/>
<text text-anchor="middle" x="708" y="-728.3" font-family="Times,serif" font-size="14.00">struct rb_root_cachedi_mmap;</text>
<text text-anchor="middle" x="708" y="-713.3" font-family="Times,serif" font-size="14.00">//Tree of private and shared mappings.</text>
<polyline fill="none" stroke="black" points="515,-705.5 901,-705.5 "/>
<text text-anchor="middle" x="708" y="-690.3" font-family="Times,serif" font-size="14.00">struct rw_semaphorei_mmap_rwsem;</text>
<text text-anchor="middle" x="708" y="-675.3" font-family="Times,serif" font-size="14.00">//Protects @i_mmap and @i_mmap_writable.</text>
<polyline fill="none" stroke="black" points="515,-667.5 901,-667.5 "/>
<text text-anchor="middle" x="708" y="-652.3" font-family="Times,serif" font-size="14.00">unsigned longnrpages;</text>
<text text-anchor="middle" x="708" y="-637.3" font-family="Times,serif" font-size="14.00">//Number of page entries, protected by the i_pages lock.</text>
<polyline fill="none" stroke="black" points="515,-629.5 901,-629.5 "/>
<text text-anchor="middle" x="708" y="-614.3" font-family="Times,serif" font-size="14.00">pgoff_twriteback_index;</text>
<text text-anchor="middle" x="708" y="-599.3" font-family="Times,serif" font-size="14.00">//Writeback starts here.</text>
<polyline fill="none" stroke="black" points="515,-591.5 901,-591.5 "/>
<text text-anchor="middle" x="708" y="-576.3" font-family="Times,serif" font-size="14.00">const struct address_space_operations *a_ops;</text>
<text text-anchor="middle" x="708" y="-561.3" font-family="Times,serif" font-size="14.00">//Methods.</text>
<polyline fill="none" stroke="black" points="515,-553.5 901,-553.5 "/>
<text text-anchor="middle" x="708" y="-538.3" font-family="Times,serif" font-size="14.00">unsigned longflags;</text>
<text text-anchor="middle" x="708" y="-523.3" font-family="Times,serif" font-size="14.00">//Error bits and flags (AS_*).</text>
<polyline fill="none" stroke="black" points="515,-515.5 901,-515.5 "/>
<text text-anchor="middle" x="708" y="-500.3" font-family="Times,serif" font-size="14.00">errseq_twb_err;</text>
<text text-anchor="middle" x="708" y="-485.3" font-family="Times,serif" font-size="14.00">//The most recent error which has occurred.</text>
<polyline fill="none" stroke="black" points="515,-477.5 901,-477.5 "/>
<text text-anchor="middle" x="708" y="-462.3" font-family="Times,serif" font-size="14.00">spinlock_tprivate_lock;</text>
<text text-anchor="middle" x="708" y="-447.3" font-family="Times,serif" font-size="14.00">//For use by the owner of the address_space.</text>
<polyline fill="none" stroke="black" points="515,-439.5 901,-439.5 "/>
<text text-anchor="middle" x="708" y="-424.3" font-family="Times,serif" font-size="14.00">struct list_headprivate_list;</text>
<text text-anchor="middle" x="708" y="-409.3" font-family="Times,serif" font-size="14.00">//For use by the owner of the address_space.</text>
<polyline fill="none" stroke="black" points="515,-401.5 901,-401.5 "/>
<text text-anchor="middle" x="708" y="-386.3" font-family="Times,serif" font-size="14.00">void*private_data;</text>
<text text-anchor="middle" x="708" y="-371.3" font-family="Times,serif" font-size="14.00">//For use by the owner of the address_space.</text>
<polyline fill="none" stroke="black" points="515,-363.5 901,-363.5 "/>
<text text-anchor="middle" x="708" y="-348.3" font-family="Times,serif" font-size="14.00">}</text>
</g>
<!-- file&#45;&gt;address_space -->
<g id="edge6" class="edge">
<title>file:f19&#45;&gt;address_space:f0</title>
<path fill="none" stroke="black" d="M479,-2015C535.27,-2015 463.35,-1050.23 507.6,-959.78"/>
<polygon fill="black" stroke="black" points="509.99,-962.34 515,-953 505.26,-957.18 509.99,-962.34"/>
</g>
</g>
</svg>
