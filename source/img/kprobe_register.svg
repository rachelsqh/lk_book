<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="1110pt" height="956pt"
 viewBox="0.00 0.00 1110.00 956.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 952)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-952 1106,-952 1106,4 -4,4"/>
<text text-anchor="middle" x="551" y="-7.8" font-family="Times,serif" font-size="14.00">kprobe:register</text>
<g id="clust1" class="cluster">
<title>cluster_0</title>
<polygon fill="none" stroke="black" points="8,-757 8,-904 455,-904 455,-757 8,-757"/>
<text text-anchor="middle" x="231.5" y="-888.8" font-family="Times,serif" font-size="14.00">kprobe_addr&#45;&gt; _kprobe_addr &#45;&gt; kprobe_lookup_name:从符号表中获取地址</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_4</title>
<polygon fill="none" stroke="black" points="302,-247 302,-613 538,-613 538,-247 302,-247"/>
<text text-anchor="middle" x="420" y="-597.8" font-family="Times,serif" font-size="14.00">prepare_kprobe &#45;&gt; arch_prepare_kprobe</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_5</title>
<polygon fill="none" stroke="black" points="714,-31 714,-466 1094,-466 1094,-31 714,-31"/>
<text text-anchor="middle" x="904" y="-450.8" font-family="Times,serif" font-size="14.00">arm_kprobe &#45;&gt; __arm_kprobe</text>
</g>
<!-- a0 -->
<g id="node1" class="node">
<title>a0</title>
<polygon fill="none" stroke="black" points="482,-948 322,-948 322,-912 482,-912 482,-948"/>
<text text-anchor="middle" x="402" y="-926.3" font-family="Times,serif" font-size="14.00">p&#45;&gt;addr = kprobe_addr(p)</text>
</g>
<!-- a1 -->
<g id="node2" class="node">
<title>a1</title>
<polygon fill="none" stroke="black" points="599.5,-873 474.5,-873 474.5,-837 599.5,-837 599.5,-873"/>
<text text-anchor="middle" x="537" y="-851.3" font-family="Times,serif" font-size="14.00">__get_valid_kprobe</text>
</g>
<!-- a0&#45;&gt;a1 -->
<g id="edge1" class="edge">
<title>a0&#45;&gt;a1</title>
<path fill="none" stroke="black" d="M442.81,-911.92C448.31,-909.39 453.83,-906.71 459,-904 473.67,-896.31 489.32,-886.93 502.72,-878.51"/>
<polygon fill="black" stroke="black" points="504.61,-881.46 511.17,-873.14 500.85,-875.55 504.61,-881.46"/>
</g>
<!-- b0 -->
<g id="node9" class="node">
<title>b0</title>
<polygon fill="none" stroke="black" points="446.5,-873 87.5,-873 87.5,-837 446.5,-837 446.5,-873"/>
<text text-anchor="middle" x="267" y="-851.3" font-family="Times,serif" font-size="14.00">addr/offset = kprobe_lookup_name &#45;&gt; kallsyms_lookup_name</text>
</g>
<!-- a0&#45;&gt;b0 -->
<g id="edge8" class="edge">
<title>a0&#45;&gt;b0</title>
<path fill="none" stroke="black" d="M370.35,-911.88C348.68,-900.17 320.08,-884.7 298.45,-873.01"/>
</g>
<!-- a2 -->
<g id="node3" class="node">
<title>a2</title>
<polygon fill="none" stroke="black" points="631,-801 463,-801 463,-765 631,-765 631,-801"/>
<text text-anchor="middle" x="547" y="-779.3" font-family="Times,serif" font-size="14.00">check_kprobe_address_safe</text>
</g>
<!-- a1&#45;&gt;a2 -->
<g id="edge2" class="edge">
<title>a1&#45;&gt;a2</title>
<path fill="none" stroke="black" d="M539.47,-836.7C540.57,-828.98 541.9,-819.71 543.13,-811.11"/>
<polygon fill="black" stroke="black" points="546.61,-811.5 544.56,-801.1 539.68,-810.51 546.61,-811.5"/>
</g>
<!-- a3 -->
<g id="node4" class="node">
<title>a3</title>
<polygon fill="none" stroke="black" points="609,-729 485,-729 485,-693 609,-693 609,-729"/>
<text text-anchor="middle" x="547" y="-707.3" font-family="Times,serif" font-size="14.00">old_p = get_kprobe</text>
</g>
<!-- a2&#45;&gt;a3 -->
<g id="edge3" class="edge">
<title>a2&#45;&gt;a3</title>
<path fill="none" stroke="black" d="M547,-764.7C547,-756.98 547,-747.71 547,-739.11"/>
<polygon fill="black" stroke="black" points="550.5,-739.1 547,-729.1 543.5,-739.1 550.5,-739.1"/>
</g>
<!-- a4 -->
<g id="node5" class="node">
<title>a4</title>
<polygon fill="none" stroke="black" points="597.5,-657 496.5,-657 496.5,-621 597.5,-621 597.5,-657"/>
<text text-anchor="middle" x="547" y="-635.3" font-family="Times,serif" font-size="14.00">prepare_kprobe</text>
</g>
<!-- a3&#45;&gt;a4 -->
<g id="edge4" class="edge">
<title>a3&#45;&gt;a4</title>
<path fill="none" stroke="black" d="M547,-692.7C547,-684.98 547,-675.71 547,-667.11"/>
<polygon fill="black" stroke="black" points="550.5,-667.1 547,-657.1 543.5,-667.1 550.5,-667.1"/>
</g>
<!-- a5 -->
<g id="node6" class="node">
<title>a5</title>
<polygon fill="none" stroke="black" points="741,-582 547,-582 547,-546 741,-546 741,-582"/>
<text text-anchor="middle" x="644" y="-560.3" font-family="Times,serif" font-size="14.00">kprobe_table(p&#45;&gt;addr,..):add list</text>
</g>
<!-- a4&#45;&gt;a5 -->
<g id="edge5" class="edge">
<title>a4&#45;&gt;a5</title>
<path fill="none" stroke="black" d="M569.99,-620.7C582.79,-611.06 598.91,-598.93 612.84,-588.45"/>
<polygon fill="black" stroke="black" points="615.29,-590.99 621.18,-582.18 611.08,-585.39 615.29,-590.99"/>
</g>
<!-- f0 -->
<g id="node10" class="node">
<title>f0</title>
<polygon fill="none" stroke="black" points="529,-582 371,-582 371,-546 529,-546 529,-582"/>
<text text-anchor="middle" x="450" y="-560.3" font-family="Times,serif" font-size="14.00">alternatives_text_reserved</text>
</g>
<!-- a4&#45;&gt;f0 -->
<g id="edge9" class="edge">
<title>a4&#45;&gt;f0</title>
<path fill="none" stroke="black" d="M524.01,-620.7C508.55,-609.06 488.25,-593.79 472.82,-582.18"/>
</g>
<!-- a6 -->
<g id="node7" class="node">
<title>a6</title>
<polygon fill="none" stroke="black" points="735,-510 553,-510 553,-474 735,-474 735,-510"/>
<text text-anchor="middle" x="644" y="-488.3" font-family="Times,serif" font-size="14.00">arm_kprobe：处理函数主题</text>
</g>
<!-- a5&#45;&gt;a6 -->
<g id="edge6" class="edge">
<title>a5&#45;&gt;a6</title>
<path fill="none" stroke="black" d="M644,-545.7C644,-537.98 644,-528.71 644,-520.11"/>
<polygon fill="black" stroke="black" points="647.5,-520.1 644,-510.1 640.5,-520.1 647.5,-520.1"/>
</g>
<!-- a7 -->
<g id="node8" class="node">
<title>a7</title>
<polygon fill="none" stroke="black" points="705,-435 557,-435 557,-399 705,-399 705,-435"/>
<text text-anchor="middle" x="631" y="-413.3" font-family="Times,serif" font-size="14.00">try_to_optimize_kprobe</text>
</g>
<!-- a6&#45;&gt;a7 -->
<g id="edge7" class="edge">
<title>a6&#45;&gt;a7</title>
<path fill="none" stroke="black" d="M640.92,-473.7C639.4,-465.15 637.53,-454.65 635.82,-445.07"/>
<polygon fill="black" stroke="black" points="639.26,-444.41 634.06,-435.18 632.37,-445.63 639.26,-444.41"/>
</g>
<!-- g0 -->
<g id="node11" class="node">
<title>g0</title>
<polygon fill="none" stroke="black" points="862.5,-435 723.5,-435 723.5,-399 862.5,-399 862.5,-435"/>
<text text-anchor="middle" x="793" y="-413.3" font-family="Times,serif" font-size="14.00">get_optimized_kprobe</text>
</g>
<!-- a6&#45;&gt;g0 -->
<g id="edge10" class="edge">
<title>a6&#45;&gt;g0</title>
<path fill="none" stroke="black" d="M695.72,-473.88C701.95,-471.42 708.17,-468.77 714,-466 732.69,-457.1 752.6,-444.98 767.76,-435.15"/>
</g>
<!-- b1 -->
<g id="node12" class="node">
<title>b1</title>
<polygon fill="none" stroke="black" points="330.5,-801 203.5,-801 203.5,-765 330.5,-765 330.5,-801"/>
<text text-anchor="middle" x="267" y="-779.3" font-family="Times,serif" font-size="14.00">addr = addr + offset</text>
</g>
<!-- b0&#45;&gt;b1 -->
<g id="edge11" class="edge">
<title>b0&#45;&gt;b1</title>
<path fill="none" stroke="black" d="M267,-836.7C267,-828.98 267,-819.71 267,-811.11"/>
<polygon fill="black" stroke="black" points="270.5,-811.1 267,-801.1 263.5,-811.1 270.5,-811.1"/>
</g>
<!-- f1 -->
<g id="node13" class="node">
<title>f1</title>
<polygon fill="none" stroke="black" points="486.5,-510 413.5,-510 413.5,-474 486.5,-474 486.5,-510"/>
<text text-anchor="middle" x="450" y="-488.3" font-family="Times,serif" font-size="14.00">can_probe</text>
</g>
<!-- f0&#45;&gt;f1 -->
<g id="edge12" class="edge">
<title>f0&#45;&gt;f1</title>
<path fill="none" stroke="black" d="M450,-545.7C450,-537.98 450,-528.71 450,-520.11"/>
<polygon fill="black" stroke="black" points="453.5,-520.1 450,-510.1 446.5,-520.1 453.5,-520.1"/>
</g>
<!-- g1 -->
<g id="node17" class="node">
<title>g1</title>
<polygon fill="none" stroke="black" points="849.5,-363 736.5,-363 736.5,-327 849.5,-327 849.5,-363"/>
<text text-anchor="middle" x="793" y="-341.3" font-family="Times,serif" font-size="14.00">arch_arm_kprobe</text>
</g>
<!-- g0&#45;&gt;g1 -->
<g id="edge20" class="edge">
<title>g0&#45;&gt;g1</title>
<path fill="none" stroke="black" d="M793,-398.7C793,-390.98 793,-381.71 793,-373.11"/>
<polygon fill="black" stroke="black" points="796.5,-373.1 793,-363.1 789.5,-373.1 796.5,-373.1"/>
</g>
<!-- f2 -->
<g id="node14" class="node">
<title>f2</title>
<polygon fill="none" stroke="black" points="513.5,-435 386.5,-435 386.5,-399 513.5,-399 513.5,-435"/>
<text text-anchor="middle" x="450" y="-413.3" font-family="Times,serif" font-size="14.00">insn = get_insn_slot</text>
</g>
<!-- f1&#45;&gt;f2 -->
<g id="edge13" class="edge">
<title>f1&#45;&gt;f2</title>
<path fill="none" stroke="black" d="M450,-473.7C450,-465.25 450,-454.87 450,-445.37"/>
<polygon fill="black" stroke="black" points="453.5,-445.18 450,-435.18 446.5,-445.18 453.5,-445.18"/>
</g>
<!-- f3 -->
<g id="node15" class="node">
<title>f3</title>
<polygon fill="none" stroke="black" points="508.5,-363 391.5,-363 391.5,-327 508.5,-327 508.5,-363"/>
<text text-anchor="middle" x="450" y="-341.3" font-family="Times,serif" font-size="14.00">arch_copy_kprobe</text>
</g>
<!-- f2&#45;&gt;f3 -->
<g id="edge14" class="edge">
<title>f2&#45;&gt;f3</title>
<path fill="none" stroke="black" d="M450,-398.7C450,-390.98 450,-381.71 450,-373.11"/>
<polygon fill="black" stroke="black" points="453.5,-373.1 450,-363.1 446.5,-373.1 453.5,-373.1"/>
</g>
<!-- f4 -->
<g id="node16" class="node">
<title>f4</title>
<polygon fill="none" stroke="black" points="508.5,-291 391.5,-291 391.5,-255 508.5,-255 508.5,-291"/>
<text text-anchor="middle" x="450" y="-269.3" font-family="Times,serif" font-size="14.00">arch_copy_kprobe</text>
</g>
<!-- f3&#45;&gt;f4 -->
<g id="edge15" class="edge">
<title>f3&#45;&gt;f4</title>
<path fill="none" stroke="black" d="M450,-326.7C450,-318.98 450,-309.71 450,-301.11"/>
<polygon fill="black" stroke="black" points="453.5,-301.1 450,-291.1 446.5,-301.1 453.5,-301.1"/>
</g>
<!-- g2 -->
<g id="node18" class="node">
<title>g2</title>
<polygon fill="none" stroke="black" points="831.5,-291 722.5,-291 722.5,-255 831.5,-255 831.5,-291"/>
<text text-anchor="middle" x="777" y="-269.3" font-family="Times,serif" font-size="14.00">optimize_kprobe</text>
</g>
<!-- g1&#45;&gt;g2 -->
<g id="edge21" class="edge">
<title>g1&#45;&gt;g2</title>
<path fill="none" stroke="black" d="M789.04,-326.7C787.28,-318.98 785.16,-309.71 783.2,-301.11"/>
<polygon fill="black" stroke="black" points="786.55,-300.07 780.91,-291.1 779.73,-301.63 786.55,-300.07"/>
</g>
<!-- g10 -->
<g id="node19" class="node">
<title>g10</title>
<ellipse fill="none" stroke="black" cx="968" cy="-273" rx="118.08" ry="18"/>
<text text-anchor="middle" x="968" y="-269.3" font-family="Times,serif" font-size="14.00">int3 = INT3_INSN_OPCODE</text>
</g>
<!-- g1&#45;&gt;g10 -->
<g id="edge16" class="edge">
<title>g1&#45;&gt;g10</title>
<path fill="none" stroke="black" d="M835.81,-326.88C863.94,-315.62 900.49,-301 928.03,-289.99"/>
</g>
<!-- g11 -->
<g id="node20" class="node">
<title>g11</title>
<ellipse fill="none" stroke="black" cx="968" cy="-201" rx="111.58" ry="18"/>
<text text-anchor="middle" x="968" y="-197.3" font-family="Times,serif" font-size="14.00">text_poke(p&#45;&gt;addr,&amp;init3,1)</text>
</g>
<!-- g10&#45;&gt;g11 -->
<g id="edge17" class="edge">
<title>g10&#45;&gt;g11</title>
<path fill="none" stroke="black" d="M968,-254.7C968,-246.98 968,-237.71 968,-229.11"/>
<polygon fill="black" stroke="black" points="971.5,-229.1 968,-219.1 964.5,-229.1 971.5,-229.1"/>
</g>
<!-- g12 -->
<g id="node21" class="node">
<title>g12</title>
<ellipse fill="none" stroke="black" cx="968" cy="-129" rx="71.49" ry="18"/>
<text text-anchor="middle" x="968" y="-125.3" font-family="Times,serif" font-size="14.00">text_poke_sync()</text>
</g>
<!-- g11&#45;&gt;g12 -->
<g id="edge18" class="edge">
<title>g11&#45;&gt;g12</title>
<path fill="none" stroke="black" d="M968,-182.7C968,-174.98 968,-165.71 968,-157.11"/>
<polygon fill="black" stroke="black" points="971.5,-157.1 968,-147.1 964.5,-157.1 971.5,-157.1"/>
</g>
<!-- g13 -->
<g id="node22" class="node">
<title>g13</title>
<ellipse fill="none" stroke="black" cx="968" cy="-57" rx="87.18" ry="18"/>
<text text-anchor="middle" x="968" y="-53.3" font-family="Times,serif" font-size="14.00">perf_event_text_poke</text>
</g>
<!-- g12&#45;&gt;g13 -->
<g id="edge19" class="edge">
<title>g12&#45;&gt;g13</title>
<path fill="none" stroke="black" d="M968,-110.7C968,-102.98 968,-93.71 968,-85.11"/>
<polygon fill="black" stroke="black" points="971.5,-85.1 968,-75.1 964.5,-85.1 971.5,-85.1"/>
</g>
</g>
</svg>
