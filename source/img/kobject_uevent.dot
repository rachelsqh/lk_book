digraph G {

	label = "kobject_uevent处理流程"
	
	subgraph cluster_0 {
		start [shape=Mdiamond];

		color = black;
		a0 -> a1 -> a2 -> a3 -> a4 ->a5 -> a6 -> a7;
		
		label = "kobject_uevent_env";
	
		subgraph cluster_1 {
			b0 -> b1 [label = "yes"];
			b0 -> b2 [label = "no"];
			b1 -> d0;
			label = "kobject_uevent_net_broadcast";
			color = black;

			subgraph cluster_3 {
			

				d0[ shape = diamond,label = "list_for_each_entry(ue_sk, &uevent_sock_list, list)" ];
				
				d1[shape = rect,label = "netlink_broadcast"];
				d2[shape = rect,label = "consume_skb"];

				
				
				d0 -> d1[label = "yes"];
				d0 -> d2[label = "no"];
				
				d1 -> d0;
				
				

				label = "uevent_net_broadcast_tagged:send netlink message";
				color = black;
			}
						
		}

		c0[shape = diamond,label = "uevent_helper[0] && !kobj_usermode_filter(kobj)" ];
			
		c1[shape = rect,label = "add_uevent_var:HOME=/ + PATH=/sbin:/bin:/usr/sbin:/usr/bin" ];
			
		c2[shape = rect,label = "init_uevent_argv" ];
			
		c3[shape = rect,label = "call_usermodehelper_setup" ];
			
		c4[shape = rect,label = "call_usermodehelper_exec"];
			
		c0 -> c1[label = "yes"];
		c0 -> end[label = "no"];
			
		c1 -> c2;
		c2 -> c3;
		c3 -> c4;

		
		u_helper [ shape = diamond,label = "if set CONFIG_UEVENT_HELPER" ];
	
	}
	
	start -> a0;

	a7 -> b0;
	d2 -> u_helper;
	
	
	a0 [ shape = rect,label = "get top_kobj" ];
	a1 [ shape = rect,label = "get kset:top_kobj->kset" ];
	
	a2 [ shape = rect,label = "uevent_ops + uevent_ops->filter + uevent_ops->filter(kset, kobj)" ];
	
	a3 [ shape = rect,label = "uevent_ops && uevent_ops->name" ];
	
	a4 [ shape = rect,label = "subsystem = uevent_ops->name || subsystem = kobject_name(&kset->kobj)" ];
	

	a5 [ shape = rect,label = "add_uevent_var:subsystem + devpath + envp_ext" ];
	
	a6 [ shape = rect,label = "uevent_ops && uevent_ops->uevent + uevent_ops->uevent()" ];
	

	a7 [ shape = rect,label = "add_uevent_var++:uevent_seqnum" ];
	
	
	b0 [ shape = diamond,label = "if (!net)" ];
	
	b2 [ shape = rect,label = "uevent_net_broadcast_untagged" ];
	
	b1 [ shape = rect,label = "uevent_net_broadcast_tagged" ];


	
	b2 -> u_helper;
	
	u_helper -> end [label = "not set CONFIG_UEVENT_HELPER" ];
	u_helper -> c0 [label = "set CONFIG_UEVENT_HELPER" ];
	
	
	c4 -> end;
	
	end [shape=Msquare];
	
	
}
