<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="1495pt" height="4872pt"
 viewBox="0.00 0.00 1495.00 4872.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 4868)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-4868 1491,-4868 1491,4 -4,4"/>
<text text-anchor="middle" x="743.5" y="-7.8" font-family="Times,serif" font-size="14.00">module loade</text>
<g id="clust1" class="cluster">
<title>cluster_0</title>
<polygon fill="none" stroke="black" points="8,-31 8,-4856 1479,-4856 1479,-31 8,-31"/>
<text text-anchor="middle" x="743.5" y="-4840.8" font-family="Times,serif" font-size="14.00">load_module:分配和加载模块</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_1</title>
<polygon fill="none" stroke="black" points="238,-39 238,-1198 656,-1198 656,-39 238,-39"/>
<text text-anchor="middle" x="447" y="-1182.8" font-family="Times,serif" font-size="14.00">do_init_module</text>
</g>
<!-- a0 -->
<g id="node1" class="node">
<title>a0</title>
<polygon fill="none" stroke="black" points="488.5,-4825 351.5,-4825 351.5,-4789 488.5,-4789 488.5,-4825"/>
<text text-anchor="middle" x="420" y="-4803.2" font-family="Times,serif" font-size="16.00">module_sig_check</text>
</g>
<!-- a0_note -->
<g id="node2" class="node">
<title>a0_note</title>
<polygon fill="none" stroke="black" points="1135,-4753 507,-4753 507,-4690 1141,-4690 1141,-4747 1135,-4753"/>
<polyline fill="none" stroke="black" points="1135,-4753 1135,-4747 "/>
<polyline fill="none" stroke="black" points="1141,-4747 1135,-4747 "/>
<text text-anchor="start" x="515" y="-4736.2" font-family="Times,serif" font-size="16.00">module_sig_check:</text>
<text text-anchor="start" x="515" y="-4699.2" font-family="Times,serif" font-size="16.00">				 &#160;以MODULE_SIG_STRING开始的节：如&quot;~Module signature appended ~&quot;</text>
</g>
<!-- a0&#45;&gt;a0_note -->
<g id="edge1" class="edge">
<title>a0:e&#45;&gt;a0_note:w</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M490,-4807C499.66,-4807 496.34,-4721.5 506,-4721.5"/>
</g>
<!-- a1 -->
<g id="node3" class="node">
<title>a1</title>
<polygon fill="none" stroke="black" points="488.5,-4739.5 315.5,-4739.5 315.5,-4703.5 488.5,-4703.5 488.5,-4739.5"/>
<text text-anchor="middle" x="402" y="-4717.7" font-family="Times,serif" font-size="16.00">elf_validity_check(info)</text>
</g>
<!-- a0&#45;&gt;a1 -->
<g id="edge3" class="edge">
<title>a0:s&#45;&gt;a1:n</title>
<path fill="none" stroke="black" d="M420,-4789C420,-4769.96 407.66,-4764.96 403.41,-4750.75"/>
<polygon fill="black" stroke="black" points="406.83,-4749.93 402,-4740.5 399.9,-4750.88 406.83,-4749.93"/>
</g>
<!-- a1_note -->
<g id="node4" class="node">
<title>a1_note</title>
<polygon fill="none" stroke="black" points="802.5,-4654 489.5,-4654 489.5,-4591 808.5,-4591 808.5,-4648 802.5,-4654"/>
<polyline fill="none" stroke="black" points="802.5,-4654 802.5,-4648 "/>
<polyline fill="none" stroke="black" points="808.5,-4648 802.5,-4648 "/>
<text text-anchor="start" x="497.5" y="-4637.2" font-family="Times,serif" font-size="16.00">elf_validity_check(info):</text>
<text text-anchor="start" x="497.5" y="-4600.2" font-family="Times,serif" font-size="16.00">				 &#160;模块ELF格式有效性检查;</text>
</g>
<!-- a1&#45;&gt;a1_note -->
<g id="edge2" class="edge">
<title>a1:e&#45;&gt;a1_note:w</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M490,-4721.5C512,-4721.5 466,-4622.5 488,-4622.5"/>
</g>
<!-- a2 -->
<g id="node5" class="node">
<title>a2</title>
<polygon fill="none" stroke="black" points="462.5,-4640.5 341.5,-4640.5 341.5,-4604.5 462.5,-4604.5 462.5,-4640.5"/>
<text text-anchor="middle" x="402" y="-4618.7" font-family="Times,serif" font-size="16.00">setup_load_info</text>
</g>
<!-- a1&#45;&gt;a2 -->
<g id="edge5" class="edge">
<title>a1:s&#45;&gt;a2:n</title>
<path fill="none" stroke="black" d="M402,-4702.5C402,-4679.1 402,-4670.84 402,-4651.58"/>
<polygon fill="black" stroke="black" points="405.5,-4651.5 402,-4641.5 398.5,-4651.5 405.5,-4651.5"/>
</g>
<!-- a2_note -->
<g id="node6" class="node">
<title>a2_note</title>
<polygon fill="none" stroke="black" points="953,-4555 485,-4555 485,-4492 959,-4492 959,-4549 953,-4555"/>
<polyline fill="none" stroke="black" points="953,-4555 953,-4549 "/>
<polyline fill="none" stroke="black" points="959,-4549 953,-4549 "/>
<text text-anchor="start" x="493" y="-4538.2" font-family="Times,serif" font-size="16.00">setup_load_info(info,flags):</text>
<text text-anchor="start" x="493" y="-4501.2" font-family="Times,serif" font-size="16.00">				 &#160;解析内核模块文件，根据节信息初始化info结构;</text>
</g>
<!-- a2&#45;&gt;a2_note -->
<g id="edge4" class="edge">
<title>a2:e&#45;&gt;a2_note:w</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M463,-4622.5C468.62,-4622.5 478.38,-4523.5 484,-4523.5"/>
</g>
<!-- a3 -->
<g id="node7" class="node">
<title>a3</title>
<polygon fill="none" stroke="black" points="467,-4541.5 291,-4541.5 291,-4505.5 467,-4505.5 467,-4541.5"/>
<text text-anchor="middle" x="379" y="-4519.7" font-family="Times,serif" font-size="16.00">blacklisted(info&#45;&gt;name))</text>
</g>
<!-- a2&#45;&gt;a3 -->
<g id="edge7" class="edge">
<title>a2:s&#45;&gt;a3:n</title>
<path fill="none" stroke="black" d="M402,-4603.5C402,-4578.26 384.55,-4572.69 380.05,-4552.52"/>
<polygon fill="black" stroke="black" points="383.52,-4552.08 379,-4542.5 376.56,-4552.81 383.52,-4552.08"/>
</g>
<!-- a3_note -->
<g id="node8" class="node">
<title>a3_note</title>
<polygon fill="none" stroke="black" points="924.5,-4456 493.5,-4456 493.5,-4393 930.5,-4393 930.5,-4450 924.5,-4456"/>
<polyline fill="none" stroke="black" points="924.5,-4456 924.5,-4450 "/>
<polyline fill="none" stroke="black" points="930.5,-4450 924.5,-4450 "/>
<text text-anchor="start" x="501.5" y="-4439.2" font-family="Times,serif" font-size="16.00">blacklisted:</text>
<text text-anchor="start" x="501.5" y="-4402.2" font-family="Times,serif" font-size="16.00">				 &#160;模块是否在黑名单中:module_blacklist结构;</text>
</g>
<!-- a3&#45;&gt;a3_note -->
<g id="edge6" class="edge">
<title>a3:e&#45;&gt;a3_note:w</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M468,-4523.5C469.41,-4523.5 490.59,-4424.5 492,-4424.5"/>
</g>
<!-- a4 -->
<g id="node9" class="node">
<title>a4</title>
<polygon fill="none" stroke="black" points="475,-4442.5 233,-4442.5 233,-4406.5 475,-4406.5 475,-4442.5"/>
<text text-anchor="middle" x="354" y="-4420.7" font-family="Times,serif" font-size="16.00">rewrite_section_headers(info,flags)</text>
</g>
<!-- a3&#45;&gt;a4 -->
<g id="edge9" class="edge">
<title>a3:s&#45;&gt;a4:n</title>
<path fill="none" stroke="black" d="M379,-4504.5C379,-4478.98 360.03,-4473.87 355.14,-4453.61"/>
<polygon fill="black" stroke="black" points="358.6,-4453.04 354,-4443.5 351.64,-4453.83 358.6,-4453.04"/>
</g>
<!-- a4_note -->
<g id="node10" class="node">
<title>a4_note</title>
<polygon fill="none" stroke="black" points="1470.5,-4357 553.5,-4357 553.5,-4183 1470.5,-4183 1470.5,-4357"/>
<text text-anchor="start" x="561.5" y="-4340.2" font-family="Times,serif" font-size="16.00">rewrite_section_headers(info,flags):</text>
<text text-anchor="start" x="561.5" y="-4303.2" font-family="Times,serif" font-size="16.00">				 &#160;info&#45;&gt;sechdrs[i].sh_addr = info&#45;&gt;hdr + info&#45;&gt;sechdrs[i].&#45;&gt;sh_offset:将文件内便宜修改为hdr内偏移，并获取内存地址</text>
<text text-anchor="start" x="561.5" y="-4266.2" font-family="Times,serif" font-size="16.00">				 &#160;跟踪但不保留：</text>
<text text-anchor="start" x="561.5" y="-4229.2" font-family="Times,serif" font-size="16.00">			 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;info&#45;&gt;sechdrs[info&#45;&gt;index.vers].sh_flags &amp;= ~(unsigned long)SHF_ALLOC</text>
<text text-anchor="start" x="561.5" y="-4192.2" font-family="Times,serif" font-size="16.00">		 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;info&#45;&gt;sechdrs[info&#45;&gt;index.info].sh_flags &amp;= ~(unsigned long)SHF_ALLOC</text>
</g>
<!-- a4&#45;&gt;a4_note -->
<g id="edge8" class="edge">
<title>a4:e&#45;&gt;a4_note:w</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M476,-4424.5C490.56,-4424.5 476.14,-4404.55 485,-4393 503.93,-4368.32 528.6,-4383.43 545,-4357 550.11,-4348.76 542.3,-4270 552,-4270"/>
</g>
<!-- a5 -->
<g id="node11" class="node">
<title>a5</title>
<polygon fill="none" stroke="black" points="535.5,-4288 16.5,-4288 16.5,-4252 535.5,-4252 535.5,-4288"/>
<text text-anchor="start" x="24.5" y="-4266.2" font-family="Times,serif" font-size="16.00">check_modstruct_vesion(info,info&#45;&gt;mod):校验符号版本:module_layout版本</text>
</g>
<!-- a4&#45;&gt;a5 -->
<g id="edge10" class="edge">
<title>a4:s&#45;&gt;a5:n</title>
<path fill="none" stroke="black" d="M354,-4405.5C354,-4346.84 284.87,-4350.6 276.77,-4299.26"/>
<polygon fill="black" stroke="black" points="280.24,-4298.71 276,-4289 273.26,-4299.23 280.24,-4298.71"/>
</g>
<!-- a6 -->
<g id="node12" class="node">
<title>a6</title>
<polygon fill="none" stroke="black" points="384.5,-4147 167.5,-4147 167.5,-4111 384.5,-4111 384.5,-4147"/>
<text text-anchor="middle" x="276" y="-4125.2" font-family="Times,serif" font-size="16.00">layout_and_allocate(info,flags)</text>
</g>
<!-- a5&#45;&gt;a6 -->
<g id="edge12" class="edge">
<title>a5:s&#45;&gt;a6:n</title>
<path fill="none" stroke="black" d="M276,-4251C276,-4208.39 276,-4195.24 276,-4157.23"/>
<polygon fill="black" stroke="black" points="279.5,-4157 276,-4147 272.5,-4157 279.5,-4157"/>
</g>
<!-- a6_note -->
<g id="node13" class="node">
<title>a6_note</title>
<polygon fill="none" stroke="black" points="1046,-4075 456,-4075 456,-3383 1052,-3383 1052,-4069 1046,-4075"/>
<polyline fill="none" stroke="black" points="1046,-4075 1046,-4069 "/>
<polyline fill="none" stroke="black" points="1052,-4069 1046,-4069 "/>
<text text-anchor="start" x="464" y="-4058.2" font-family="Times,serif" font-size="16.00">layout_and_allocate(info,flags):</text>
<text text-anchor="start" x="464" y="-4021.2" font-family="Times,serif" font-size="16.00">				 &#160;计算模块布局，并分配所有内存,放置到最终位置:</text>
<text text-anchor="start" x="464" y="-3984.2" font-family="Times,serif" font-size="16.00">				 &#160;&#160;check_modinfo(info&#45;&gt;mod,info,flags):</text>
<text text-anchor="start" x="464" y="-3947.2" font-family="Times,serif" font-size="16.00">				 &#160;&#160;&#45;vermagic</text>
<text text-anchor="start" x="464" y="-3910.2" font-family="Times,serif" font-size="16.00">				 &#160;&#160;&#45;intree</text>
<text text-anchor="start" x="464" y="-3873.2" font-family="Times,serif" font-size="16.00">				 &#160;&#160;&#45;staging ：会警告</text>
<text text-anchor="start" x="464" y="-3836.2" font-family="Times,serif" font-size="16.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;livepatch</text>
<text text-anchor="start" x="464" y="-3799.2" font-family="Times,serif" font-size="16.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#45;license</text>
<text text-anchor="start" x="464" y="-3762.2" font-family="Times,serif" font-size="16.00">				 &#160;&#160;module_frob_arch_sections:</text>
<text text-anchor="start" x="464" y="-3725.2" font-family="Times,serif" font-size="16.00">				 &#160;&#160;module_enforce_rwx_sections:</text>
<text text-anchor="start" x="464" y="-3688.2" font-family="Times,serif" font-size="16.00">				 &#160;&#160;index.pcu:其分配采用不同方法：</text>
<text text-anchor="start" x="464" y="-3651.2" font-family="Times,serif" font-size="16.00">			 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;.data..ro_after_init节：sh_flags |= SHF_RO_AFTER_INIT</text>
<text text-anchor="start" x="464" y="-3614.2" font-family="Times,serif" font-size="16.00">				 &#160;&#160;__jump_table节：sh_flags |= SHF_RO_AFTER_INIT</text>
<text text-anchor="start" x="464" y="-3577.2" font-family="Times,serif" font-size="16.00">				 &#160;&#160;通用处理：</text>
<text text-anchor="start" x="464" y="-3540.2" font-family="Times,serif" font-size="16.00">				 &#160;&#160;layout_sections(info&#45;mod,info):</text>
<text text-anchor="start" x="464" y="-3503.2" font-family="Times,serif" font-size="16.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;layout_symtab(info&#45;&gt;mod,info):</text>
<text text-anchor="start" x="464" y="-3466.2" font-family="Times,serif" font-size="16.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;move_module(info&#45;&gt;mod,info):放入最终位置</text>
<text text-anchor="start" x="464" y="-3429.2" font-family="Times,serif" font-size="16.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;mod = info&#45;&gt;sehdrs[info&#45;&gt;index.mod].sh_addr:这是模块的最终状态</text>
<text text-anchor="start" x="464" y="-3392.2" font-family="Times,serif" font-size="16.00"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;kmemleak_load_module(mod,info):内核模块泄漏检查？</text>
</g>
<!-- a6&#45;&gt;a6_note -->
<g id="edge11" class="edge">
<title>a6:e&#45;&gt;a6_note:w</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M386,-4129C422.54,-4129 432.53,-4108.1 448,-4075 452.07,-4066.29 445.39,-3729 455,-3729"/>
</g>
<!-- a7 -->
<g id="node14" class="node">
<title>a7</title>
<polygon fill="none" stroke="black" points="438.5,-3747 109.5,-3747 109.5,-3711 438.5,-3711 438.5,-3747"/>
<text text-anchor="middle" x="274" y="-3725.2" font-family="Times,serif" font-size="16.00">audit_log_kern_module(mod&#45;&gt;name):审计hook</text>
</g>
<!-- a6&#45;&gt;a7 -->
<g id="edge13" class="edge">
<title>a6:s&#45;&gt;a7:n</title>
<path fill="none" stroke="black" d="M276,-4111C276,-3953.13 274.09,-3911.12 274,-3758.23"/>
<polygon fill="black" stroke="black" points="277.5,-3758 274,-3748 270.5,-3758 277.5,-3758"/>
</g>
<!-- a8 -->
<g id="node15" class="node">
<title>a8</title>
<polygon fill="none" stroke="black" points="383.5,-3347 164.5,-3347 164.5,-3303 383.5,-3303 383.5,-3347"/>
<text text-anchor="start" x="172.5" y="-3330.2" font-family="Times,serif" font-size="16.00">add_unformed_module(mode):</text>
<text text-anchor="middle" x="274" y="-3312.2" font-family="Times,serif" font-size="16.00">保持模块在系统中的唯一性</text>
</g>
<!-- a7&#45;&gt;a8 -->
<g id="edge14" class="edge">
<title>a7:s&#45;&gt;a8:n</title>
<path fill="none" stroke="black" d="M274,-3710C274,-3552.13 274,-3510.12 274,-3357.23"/>
<polygon fill="black" stroke="black" points="277.5,-3357 274,-3347 270.5,-3357 277.5,-3357"/>
</g>
<!-- a9 -->
<g id="node16" class="node">
<title>a9</title>
<polygon fill="none" stroke="black" points="373,-3267 175,-3267 175,-3231 373,-3231 373,-3267"/>
<text text-anchor="start" x="183" y="-3245.2" font-family="Times,serif" font-size="16.00">percpu_modalloc(mod,info)</text>
</g>
<!-- a8&#45;&gt;a9 -->
<g id="edge15" class="edge">
<title>a8:s&#45;&gt;a9:n</title>
<path fill="none" stroke="black" d="M274,-3303C274,-3291 274,-3285.75 274,-3277.12"/>
<polygon fill="black" stroke="black" points="277.5,-3277 274,-3267 270.5,-3277 277.5,-3277"/>
</g>
<!-- a11 -->
<g id="node17" class="node">
<title>a11</title>
<polygon fill="none" stroke="black" points="386.5,-3195 161.5,-3195 161.5,-3159 386.5,-3159 386.5,-3195"/>
<text text-anchor="start" x="169.5" y="-3173.2" font-family="Times,serif" font-size="16.00">find_module_sections(modinfo)</text>
</g>
<!-- a9&#45;&gt;a11 -->
<g id="edge17" class="edge">
<title>a9:s&#45;&gt;a11:n</title>
<path fill="none" stroke="black" d="M274,-3231C274,-3219 274,-3213.75 274,-3205.12"/>
<polygon fill="black" stroke="black" points="277.5,-3205 274,-3195 270.5,-3205 277.5,-3205"/>
</g>
<!-- a11_note -->
<g id="node18" class="node">
<title>a11_note</title>
<polygon fill="none" stroke="black" points="976.5,-3123 437.5,-3123 437.5,-2568 982.5,-2568 982.5,-3117 976.5,-3123"/>
<polyline fill="none" stroke="black" points="976.5,-3123 976.5,-3117 "/>
<polyline fill="none" stroke="black" points="982.5,-3117 976.5,-3117 "/>
<text text-anchor="start" x="445.5" y="-3106.2" font-family="Times,serif" font-size="16.00">find_module_sections(modinfo):</text>
<text text-anchor="start" x="445.5" y="-3069.2" font-family="Times,serif" font-size="16.00">				 &#160;&#160;初始化各个节的基地址mod&#45;&gt;:</text>
<text text-anchor="start" x="445.5" y="-3032.2" font-family="Times,serif" font-size="16.00">				 &#160;&#160;&#45;&#45;kp = __param;</text>
<text text-anchor="start" x="445.5" y="-3014.2" font-family="Times,serif" font-size="16.00">&#45;&#45;syms = __ksymtab;</text>
<text text-anchor="start" x="445.5" y="-2996.2" font-family="Times,serif" font-size="16.00">&#45;&#45;crcs = __kcrctab;</text>
<text text-anchor="start" x="445.5" y="-2978.2" font-family="Times,serif" font-size="16.00">&#45;&#45;gpl_syms = __ksymtab_gpl;</text>
<text text-anchor="start" x="445.5" y="-2960.2" font-family="Times,serif" font-size="16.00">&#45;&#45;gpl_crcs = ++kcrctab_gpl;</text>
<text text-anchor="start" x="445.5" y="-2923.2" font-family="Times,serif" font-size="16.00">				 &#160;&#160;&#45;&#45;ctors = .ctors/.init_array/:只能有二选一的节，不能同时有;</text>
<text text-anchor="start" x="445.5" y="-2905.2" font-family="Times,serif" font-size="16.00">&#45;&#45;noinstr_text_start = .noinstr.text;</text>
<text text-anchor="start" x="445.5" y="-2868.2" font-family="Times,serif" font-size="16.00">				 &#160;&#160;&#45;&#45;tracepoints_ptrs = __tracepoints_ptrs;</text>
<text text-anchor="start" x="445.5" y="-2850.2" font-family="Times,serif" font-size="16.00"> &#45;&#45;srcu_struct_ptrs = ___srcu_struct_ptrs;</text>
<text text-anchor="start" x="445.5" y="-2832.2" font-family="Times,serif" font-size="16.00">&#45;&#45;bpf_raw_events = __bpf_raw_tp_map;</text>
<text text-anchor="start" x="445.5" y="-2795.2" font-family="Times,serif" font-size="16.00">				 &#160;&#160;&#45;&#45;btf_data = .BTF;</text>
<text text-anchor="start" x="445.5" y="-2777.2" font-family="Times,serif" font-size="16.00">&#45;&#45;jump_entries = __jump_table;</text>
<text text-anchor="start" x="445.5" y="-2759.2" font-family="Times,serif" font-size="16.00">&#45;&#45;trace_events = _ftrace_events;</text>
<text text-anchor="start" x="445.5" y="-2741.2" font-family="Times,serif" font-size="16.00">&#45;&#45;trace_evals = _ftrace_eval_map;</text>
<text text-anchor="start" x="445.5" y="-2704.2" font-family="Times,serif" font-size="16.00">				 &#160;&#160;&#45;&#45;ftrace_callsites = section_objs(...);</text>
<text text-anchor="start" x="445.5" y="-2686.2" font-family="Times,serif" font-size="16.00">&#45;&#45;ei_funcs = _error_injection_whitelist;</text>
<text text-anchor="start" x="445.5" y="-2668.2" font-family="Times,serif" font-size="16.00">&#45;&#45;kprobes_text_start = .kprobes.text;</text>
<text text-anchor="start" x="445.5" y="-2631.2" font-family="Times,serif" font-size="16.00">				 &#160;&#160;&#45;&#45;kprobe_blacklist = _kprobe_blacklist;</text>
<text text-anchor="start" x="445.5" y="-2613.2" font-family="Times,serif" font-size="16.00">&#45;&#45;static_call_sites = .static_call_sites;</text>
<text text-anchor="start" x="445.5" y="-2595.2" font-family="Times,serif" font-size="16.00">&#45;&#45;extable = __ex_table;</text>
<text text-anchor="start" x="445.5" y="-2577.2" font-family="Times,serif" font-size="16.00">&#45;&#45;debug = __dyndbg;</text>
</g>
<!-- a11&#45;&gt;a11_note -->
<g id="edge16" class="edge">
<title>a11:e&#45;&gt;a11_note:w</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M388,-3177C418.13,-3177 419.03,-3151.44 429,-3123 431.55,-3115.72 428.29,-2845.5 436,-2845.5"/>
</g>
<!-- a12 -->
<g id="node19" class="node">
<title>a12</title>
<polygon fill="none" stroke="black" points="419.5,-2867.5 120.5,-2867.5 120.5,-2823.5 419.5,-2823.5 419.5,-2867.5"/>
<text text-anchor="start" x="128.5" y="-2850.7" font-family="Times,serif" font-size="16.00">check_module_license_and_versions(mod):</text>
<text text-anchor="start" x="128.5" y="-2832.7" font-family="Times,serif" font-size="16.00">校验许可版本</text>
</g>
<!-- a11&#45;&gt;a12 -->
<g id="edge18" class="edge">
<title>a11:s&#45;&gt;a12:n</title>
<path fill="none" stroke="black" d="M274,-3159C274,-3033.28 270.21,-2999.39 270.01,-2878.52"/>
<polygon fill="black" stroke="black" points="273.51,-2878.5 270,-2868.5 266.51,-2878.5 273.51,-2878.5"/>
</g>
<!-- a13 -->
<g id="node20" class="node">
<title>a13</title>
<polygon fill="none" stroke="black" points="366,-2532 174,-2532 174,-2488 366,-2488 366,-2532"/>
<text text-anchor="start" x="182" y="-2515.2" font-family="Times,serif" font-size="16.00">setup_modinfo(mod,info):</text>
<text text-anchor="start" x="182" y="-2497.2" font-family="Times,serif" font-size="16.00">运行模块属性的setup方法</text>
</g>
<!-- a12&#45;&gt;a13 -->
<g id="edge19" class="edge">
<title>a12:s&#45;&gt;a13:n</title>
<path fill="none" stroke="black" d="M270,-2822.5C270,-2696.79 270,-2662.88 270,-2542.01"/>
<polygon fill="black" stroke="black" points="273.5,-2542 270,-2532 266.5,-2542 273.5,-2542"/>
</g>
<!-- a14 -->
<g id="node21" class="node">
<title>a14</title>
<polygon fill="none" stroke="black" points="378,-2452 162,-2452 162,-2408 378,-2408 378,-2452"/>
<text text-anchor="start" x="170" y="-2435.2" font-family="Times,serif" font-size="16.00">simplify_symbols:处理符号，</text>
<text text-anchor="start" x="170" y="-2417.2" font-family="Times,serif" font-size="16.00">st_value直接指向指针</text>
</g>
<!-- a13&#45;&gt;a14 -->
<g id="edge20" class="edge">
<title>a13:s&#45;&gt;a14:n</title>
<path fill="none" stroke="black" d="M270,-2488C270,-2476 270,-2470.75 270,-2462.12"/>
<polygon fill="black" stroke="black" points="273.5,-2462 270,-2452 266.5,-2462 273.5,-2462"/>
</g>
<!-- a15 -->
<g id="node22" class="node">
<title>a15</title>
<polygon fill="none" stroke="black" points="335.5,-2372 204.5,-2372 204.5,-2336 335.5,-2336 335.5,-2372"/>
<text text-anchor="start" x="212.5" y="-2350.2" font-family="Times,serif" font-size="16.00">apply_relocations</text>
</g>
<!-- a14&#45;&gt;a15 -->
<g id="edge22" class="edge">
<title>a14:s&#45;&gt;a15:n</title>
<path fill="none" stroke="black" d="M270,-2408C270,-2396 270,-2390.75 270,-2382.12"/>
<polygon fill="black" stroke="black" points="273.5,-2382 270,-2372 266.5,-2382 273.5,-2382"/>
</g>
<!-- a15_note -->
<g id="node23" class="node">
<title>a15_note</title>
<polygon fill="none" stroke="black" points="470.5,-2300 341.5,-2300 341.5,-2264 476.5,-2264 476.5,-2294 470.5,-2300"/>
<polyline fill="none" stroke="black" points="470.5,-2300 470.5,-2294 "/>
<polyline fill="none" stroke="black" points="476.5,-2294 470.5,-2294 "/>
<text text-anchor="start" x="349.5" y="-2278.2" font-family="Times,serif" font-size="16.00">apply_relocations:</text>
</g>
<!-- a15&#45;&gt;a15_note -->
<g id="edge21" class="edge">
<title>a15:e&#45;&gt;a15_note:w</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M337,-2354C353.01,-2354 323.99,-2282 340,-2282"/>
</g>
<!-- a16 -->
<g id="node24" class="node">
<title>a16</title>
<polygon fill="none" stroke="black" points="323,-2300 207,-2300 207,-2264 323,-2264 323,-2300"/>
<text text-anchor="start" x="215" y="-2278.2" font-family="Times,serif" font-size="16.00">post_relocation</text>
</g>
<!-- a15&#45;&gt;a16 -->
<g id="edge24" class="edge">
<title>a15:s&#45;&gt;a16:n</title>
<path fill="none" stroke="black" d="M270,-2336C270,-2323.88 267.19,-2318.78 265.78,-2310.17"/>
<polygon fill="black" stroke="black" points="269.26,-2309.7 265,-2300 262.28,-2310.24 269.26,-2309.7"/>
</g>
<!-- a16_note -->
<g id="node25" class="node">
<title>a16_note</title>
<polygon fill="none" stroke="black" points="458,-2215 364,-2215 364,-2179 464,-2179 464,-2209 458,-2215"/>
<polyline fill="none" stroke="black" points="458,-2215 458,-2209 "/>
<polyline fill="none" stroke="black" points="464,-2209 458,-2209 "/>
<text text-anchor="start" x="372" y="-2193.2" font-family="Times,serif" font-size="16.00">重定位原理:</text>
</g>
<!-- a16&#45;&gt;a16_note -->
<g id="edge23" class="edge">
<title>a16:e&#45;&gt;a16_note:w</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M324,-2282C332.94,-2282 328.66,-2271.82 333,-2264 342.09,-2247.6 347.69,-2245.27 355,-2228 360.55,-2214.9 348.77,-2197 363,-2197"/>
</g>
<!-- a17 -->
<g id="node26" class="node">
<title>a17</title>
<polygon fill="none" stroke="black" points="345.5,-2228 166.5,-2228 166.5,-2166 345.5,-2166 345.5,-2228"/>
<text text-anchor="start" x="174.5" y="-2211.2" font-family="Times,serif" font-size="16.00">flush_module_icache :</text>
<text text-anchor="start" x="174.5" y="-2193.2" font-family="Times,serif" font-size="16.00">init_layout + core_layout</text>
<text text-anchor="start" x="174.5" y="-2175.2" font-family="Times,serif" font-size="16.00">imb</text>
</g>
<!-- a16&#45;&gt;a17 -->
<g id="edge25" class="edge">
<title>a16:s&#45;&gt;a17:n</title>
<path fill="none" stroke="black" d="M265,-2264C265,-2251.5 259.83,-2246.74 257.33,-2237.99"/>
<polygon fill="black" stroke="black" points="260.79,-2237.45 256,-2228 253.85,-2238.37 260.79,-2237.45"/>
</g>
<!-- a18 -->
<g id="node27" class="node">
<title>a18</title>
<polygon fill="none" stroke="black" points="307.5,-2130 204.5,-2130 204.5,-2094 307.5,-2094 307.5,-2130"/>
<text text-anchor="start" x="212.5" y="-2108.2" font-family="Times,serif" font-size="16.00">cfi_init(mod)</text>
</g>
<!-- a17&#45;&gt;a18 -->
<g id="edge27" class="edge">
<title>a17:s&#45;&gt;a18:n</title>
<path fill="none" stroke="black" d="M256,-2166C256,-2154 256,-2148.75 256,-2140.12"/>
<polygon fill="black" stroke="black" points="259.5,-2140 256,-2130 252.5,-2140 259.5,-2140"/>
</g>
<!-- a18_note -->
<g id="node28" class="node">
<title>a18_note</title>
<polygon fill="none" stroke="black" points="458.5,-2058 365.5,-2058 365.5,-2022 464.5,-2022 464.5,-2052 458.5,-2058"/>
<polyline fill="none" stroke="black" points="458.5,-2058 458.5,-2052 "/>
<polyline fill="none" stroke="black" points="464.5,-2052 458.5,-2052 "/>
<text text-anchor="start" x="373.5" y="-2036.2" font-family="Times,serif" font-size="16.00">cfi_init描述:</text>
</g>
<!-- a18&#45;&gt;a18_note -->
<g id="edge26" class="edge">
<title>a18:e&#45;&gt;a18_note:w</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M309,-2112C341.11,-2112 340.25,-2085.4 357,-2058 361.48,-2050.68 355.42,-2040 364,-2040"/>
</g>
<!-- a19 -->
<g id="node29" class="node">
<title>a19</title>
<polygon fill="none" stroke="black" points="347.5,-2058 130.5,-2058 130.5,-2022 347.5,-2022 347.5,-2058"/>
<text text-anchor="start" x="138.5" y="-2036.2" font-family="Times,serif" font-size="16.00">mod&#45;&gt;args:填充内核模块参数</text>
</g>
<!-- a18&#45;&gt;a19 -->
<g id="edge28" class="edge">
<title>a18:s&#45;&gt;a19:n</title>
<path fill="none" stroke="black" d="M256,-2094C256,-2080.31 245.83,-2076.85 241.22,-2067.79"/>
<polygon fill="black" stroke="black" points="244.63,-2066.98 239,-2058 237.8,-2068.53 244.63,-2066.98"/>
</g>
<!-- a20 -->
<g id="node30" class="node">
<title>a20</title>
<polygon fill="none" stroke="black" points="330,-1986 148,-1986 148,-1950 330,-1950 330,-1986"/>
<text text-anchor="start" x="156" y="-1964.2" font-family="Times,serif" font-size="16.00">init_build_id（mod,info)</text>
</g>
<!-- a19&#45;&gt;a20 -->
<g id="edge30" class="edge">
<title>a19:s&#45;&gt;a20:n</title>
<path fill="none" stroke="black" d="M239,-2022C239,-2010 239,-2004.75 239,-1996.12"/>
<polygon fill="black" stroke="black" points="242.5,-1996 239,-1986 235.5,-1996 242.5,-1996"/>
</g>
<!-- a20_note -->
<g id="node31" class="node">
<title>a20_note</title>
<polygon fill="none" stroke="black" points="465.5,-1914 334.5,-1914 334.5,-1878 471.5,-1878 471.5,-1908 465.5,-1914"/>
<polyline fill="none" stroke="black" points="465.5,-1914 465.5,-1908 "/>
<polyline fill="none" stroke="black" points="471.5,-1908 465.5,-1908 "/>
<text text-anchor="start" x="342.5" y="-1892.2" font-family="Times,serif" font-size="16.00">init_build_id理解:</text>
</g>
<!-- a20&#45;&gt;a20_note -->
<g id="edge29" class="edge">
<title>a20:e&#45;&gt;a20_note:w</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M331,-1968C347.01,-1968 316.99,-1896 333,-1896"/>
</g>
<!-- a21 -->
<g id="node32" class="node">
<title>a21</title>
<polygon fill="none" stroke="black" points="316,-1914 154,-1914 154,-1878 316,-1878 316,-1914"/>
<text text-anchor="middle" x="235" y="-1892.2" font-family="Times,serif" font-size="16.00">dynamic_debug_setup</text>
</g>
<!-- a20&#45;&gt;a21 -->
<g id="edge32" class="edge">
<title>a20:s&#45;&gt;a21:n</title>
<path fill="none" stroke="black" d="M239,-1950C239,-1937.93 236.75,-1932.77 235.62,-1924.15"/>
<polygon fill="black" stroke="black" points="239.11,-1923.77 235,-1914 232.12,-1924.2 239.11,-1923.77"/>
</g>
<!-- a21_note -->
<g id="node33" class="node">
<title>a21_note</title>
<polygon fill="none" stroke="black" points="523,-1838 331,-1838 331,-1802 529,-1802 529,-1832 523,-1838"/>
<polyline fill="none" stroke="black" points="523,-1838 523,-1832 "/>
<polyline fill="none" stroke="black" points="529,-1832 523,-1832 "/>
<text text-anchor="start" x="339" y="-1816.2" font-family="Times,serif" font-size="16.00">dynamic_debug_setup理解:</text>
</g>
<!-- a21&#45;&gt;a21_note -->
<g id="edge31" class="edge">
<title>a21:e&#45;&gt;a21_note:w</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M317,-1896C334.13,-1896 312.87,-1820 330,-1820"/>
</g>
<!-- a22 -->
<g id="node34" class="node">
<title>a22</title>
<polygon fill="none" stroke="black" points="312.5,-1842 129.5,-1842 129.5,-1798 312.5,-1798 312.5,-1842"/>
<text text-anchor="start" x="137.5" y="-1825.2" font-family="Times,serif" font-size="16.00">ftrace_module_init(mod):</text>
<text text-anchor="start" x="137.5" y="-1807.2" font-family="Times,serif" font-size="16.00">ftrace hook</text>
</g>
<!-- a21&#45;&gt;a22 -->
<g id="edge33" class="edge">
<title>a21:s&#45;&gt;a22:n</title>
<path fill="none" stroke="black" d="M235,-1878C235,-1864.86 226.79,-1860.8 222.95,-1851.92"/>
<polygon fill="black" stroke="black" points="226.36,-1851.14 221,-1842 219.49,-1852.49 226.36,-1851.14"/>
</g>
<!-- a23 -->
<g id="node35" class="node">
<title>a23</title>
<polygon fill="none" stroke="black" points="331.5,-1762 110.5,-1762 110.5,-1726 331.5,-1726 331.5,-1762"/>
<text text-anchor="start" x="118.5" y="-1740.2" font-family="Times,serif" font-size="16.00">complete_formation(mod,info):</text>
</g>
<!-- a22&#45;&gt;a23 -->
<g id="edge34" class="edge">
<title>a22:s&#45;&gt;a23:n</title>
<path fill="none" stroke="black" d="M221,-1798C221,-1786 221,-1780.75 221,-1772.12"/>
<polygon fill="black" stroke="black" points="224.5,-1772 221,-1762 217.5,-1772 224.5,-1772"/>
</g>
<!-- a24 -->
<g id="node36" class="node">
<title>a24</title>
<polygon fill="none" stroke="black" points="332,-1690 110,-1690 110,-1654 332,-1654 332,-1690"/>
<text text-anchor="start" x="118" y="-1668.2" font-family="Times,serif" font-size="16.00">prepare_coming_module(mod):</text>
</g>
<!-- a23&#45;&gt;a24 -->
<g id="edge35" class="edge">
<title>a23:s&#45;&gt;a24:n</title>
<path fill="none" stroke="black" d="M221,-1726C221,-1714 221,-1708.75 221,-1700.12"/>
<polygon fill="black" stroke="black" points="224.5,-1700 221,-1690 217.5,-1700 224.5,-1700"/>
</g>
<!-- a25 -->
<g id="node37" class="node">
<title>a25</title>
<polygon fill="none" stroke="black" points="312.5,-1618 129.5,-1618 129.5,-1582 312.5,-1582 312.5,-1618"/>
<text text-anchor="middle" x="221" y="-1596.2" font-family="Times,serif" font-size="16.00">模块参数处理:parse_args</text>
</g>
<!-- a24&#45;&gt;a25 -->
<g id="edge36" class="edge">
<title>a24:s&#45;&gt;a25:n</title>
<path fill="none" stroke="black" d="M221,-1654C221,-1642 221,-1636.75 221,-1628.12"/>
<polygon fill="black" stroke="black" points="224.5,-1628 221,-1618 217.5,-1628 224.5,-1628"/>
</g>
<!-- a26 -->
<g id="node38" class="node">
<title>a26</title>
<polygon fill="none" stroke="black" points="402,-1546 40,-1546 40,-1510 402,-1510 402,-1546"/>
<text text-anchor="middle" x="221" y="-1524.2" font-family="Times,serif" font-size="16.00">mod_sysfs_setup(mod,info,mod&#45;&gt;kp,mod&#45;&gt;num_kp)</text>
</g>
<!-- a25&#45;&gt;a26 -->
<g id="edge38" class="edge">
<title>a25:s&#45;&gt;a26:n</title>
<path fill="none" stroke="black" d="M221,-1582C221,-1570 221,-1564.75 221,-1556.12"/>
<polygon fill="black" stroke="black" points="224.5,-1556 221,-1546 217.5,-1556 224.5,-1556"/>
</g>
<!-- a26_note -->
<g id="node39" class="node">
<title>a26_note</title>
<polygon fill="none" stroke="black" points="651,-1474 415,-1474 415,-1438 657,-1438 657,-1468 651,-1474"/>
<polyline fill="none" stroke="black" points="651,-1474 651,-1468 "/>
<polyline fill="none" stroke="black" points="657,-1468 651,-1468 "/>
<text text-anchor="start" x="423" y="-1452.2" font-family="Times,serif" font-size="16.00">mod_sysfs_setup:sysfs节点初始化</text>
</g>
<!-- a26&#45;&gt;a26_note -->
<g id="edge37" class="edge">
<title>a26:e&#45;&gt;a26_note:w</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M403,-1528C419.19,-1528 397.81,-1456 414,-1456"/>
</g>
<!-- a27 -->
<g id="node40" class="node">
<title>a27</title>
<polygon fill="none" stroke="black" points="397,-1474 19,-1474 19,-1438 397,-1438 397,-1474"/>
<text text-anchor="middle" x="208" y="-1452.2" font-family="Times,serif" font-size="16.00">is_livepatch_module(mod):copy_module_elf(mod,info)</text>
</g>
<!-- a26&#45;&gt;a27 -->
<g id="edge40" class="edge">
<title>a26:s&#45;&gt;a27:n</title>
<path fill="none" stroke="black" d="M221,-1510C221,-1496.98 213.38,-1492.76 209.81,-1483.87"/>
<polygon fill="black" stroke="black" points="213.24,-1483.21 208,-1474 206.36,-1484.47 213.24,-1483.21"/>
</g>
<!-- a27_note -->
<g id="node41" class="node">
<title>a27_note</title>
<polygon fill="none" stroke="black" points="565,-1402 397,-1402 397,-1358 571,-1358 571,-1396 565,-1402"/>
<polyline fill="none" stroke="black" points="565,-1402 565,-1396 "/>
<polyline fill="none" stroke="black" points="571,-1396 565,-1396 "/>
<text text-anchor="start" x="405" y="-1385.2" font-family="Times,serif" font-size="16.00">livepatch_module:</text>
<text text-anchor="start" x="405" y="-1367.2" font-family="Times,serif" font-size="16.00">实时内核补丁部分处理</text>
</g>
<!-- a27&#45;&gt;a27_note -->
<g id="edge39" class="edge">
<title>a27:e&#45;&gt;a27_note:w</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M398,-1456C414.89,-1456 379.11,-1380 396,-1380"/>
</g>
<!-- a28 -->
<g id="node42" class="node">
<title>a28</title>
<polygon fill="none" stroke="black" points="297.5,-1398 118.5,-1398 118.5,-1362 297.5,-1362 297.5,-1398"/>
<text text-anchor="start" x="126.5" y="-1376.2" font-family="Times,serif" font-size="16.00">free_copy(info):释放info</text>
</g>
<!-- a27&#45;&gt;a28 -->
<g id="edge41" class="edge">
<title>a27:s&#45;&gt;a28:n</title>
<path fill="none" stroke="black" d="M208,-1438C208,-1424.59 208,-1418.96 208,-1409.08"/>
<polygon fill="black" stroke="black" points="211.5,-1409 208,-1399 204.5,-1409 211.5,-1409"/>
</g>
<!-- a29 -->
<g id="node43" class="node">
<title>a29</title>
<polygon fill="none" stroke="black" points="300,-1322 116,-1322 116,-1278 300,-1278 300,-1322"/>
<text text-anchor="start" x="124" y="-1305.2" font-family="Times,serif" font-size="16.00">trace_module_load(mod):</text>
<text text-anchor="start" x="124" y="-1287.2" font-family="Times,serif" font-size="16.00"> trace hook</text>
</g>
<!-- a28&#45;&gt;a29 -->
<g id="edge42" class="edge">
<title>a28:s&#45;&gt;a29:n</title>
<path fill="none" stroke="black" d="M208,-1361C208,-1347.59 208,-1341.96 208,-1332.08"/>
<polygon fill="black" stroke="black" points="211.5,-1332 208,-1322 204.5,-1332 211.5,-1332"/>
</g>
<!-- a30 -->
<g id="node44" class="node">
<title>a30</title>
<polygon fill="none" stroke="black" points="288,-1242 128,-1242 128,-1206 288,-1206 288,-1242"/>
<text text-anchor="middle" x="208" y="-1220.2" font-family="Times,serif" font-size="16.00">do_init_module(mod)</text>
</g>
<!-- a29&#45;&gt;a30 -->
<g id="edge43" class="edge">
<title>a29:s&#45;&gt;a30:n</title>
<path fill="none" stroke="black" d="M208,-1278C208,-1266 208,-1260.75 208,-1252.12"/>
<polygon fill="black" stroke="black" points="211.5,-1252 208,-1242 204.5,-1252 211.5,-1252"/>
</g>
<!-- b0 -->
<g id="node45" class="node">
<title>b0</title>
<polygon fill="none" stroke="black" points="605.5,-1167 288.5,-1167 288.5,-1131 605.5,-1131 605.5,-1167"/>
<text text-anchor="middle" x="447" y="-1145.2" font-family="Times,serif" font-size="16.00">freeinit&#45;&gt;module_init = mod&#45;&gt;init_layout.base</text>
</g>
<!-- a30&#45;&gt;b0 -->
<g id="edge58" class="edge">
<title>a30:e&#45;&gt;b0:w</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M289,-1224C322.35,-1224 253.65,-1149 287,-1149"/>
</g>
<!-- b1 -->
<g id="node46" class="node">
<title>b1</title>
<polygon fill="none" stroke="black" points="541.5,-1095 352.5,-1095 352.5,-1059 541.5,-1059 541.5,-1095"/>
<text text-anchor="start" x="360.5" y="-1073.2" font-family="Times,serif" font-size="16.00">do_mod_ctors(mod): 忽略</text>
</g>
<!-- b0&#45;&gt;b1 -->
<g id="edge44" class="edge">
<title>b0:s&#45;&gt;b1:n</title>
<path fill="none" stroke="black" d="M447,-1131C447,-1119 447,-1113.75 447,-1105.12"/>
<polygon fill="black" stroke="black" points="450.5,-1105 447,-1095 443.5,-1105 450.5,-1105"/>
</g>
<!-- b2 -->
<g id="node47" class="node">
<title>b2</title>
<polygon fill="none" stroke="black" points="601,-1023 293,-1023 293,-987 601,-987 601,-1023"/>
<text text-anchor="start" x="301" y="-1001.2" font-family="Times,serif" font-size="16.00">do_one_initcall(mod&#45;&gt;init):运行初始化句柄</text>
</g>
<!-- b1&#45;&gt;b2 -->
<g id="edge45" class="edge">
<title>b1:s&#45;&gt;b2:n</title>
<path fill="none" stroke="black" d="M447,-1059C447,-1047 447,-1041.75 447,-1033.12"/>
<polygon fill="black" stroke="black" points="450.5,-1033 447,-1023 443.5,-1033 450.5,-1033"/>
</g>
<!-- b3 -->
<g id="node48" class="node">
<title>b3</title>
<polygon fill="none" stroke="black" points="585,-951 309,-951 309,-907 585,-907 585,-951"/>
<text text-anchor="start" x="317" y="-934.2" font-family="Times,serif" font-size="16.00">mod&#45;&gt;state = MODULE_STATE_LIVE:</text>
<text text-anchor="start" x="317" y="-916.2" font-family="Times,serif" font-size="16.00">设置状态</text>
</g>
<!-- b2&#45;&gt;b3 -->
<g id="edge46" class="edge">
<title>b2:s&#45;&gt;b3:n</title>
<path fill="none" stroke="black" d="M447,-987C447,-975 447,-969.75 447,-961.12"/>
<polygon fill="black" stroke="black" points="450.5,-961 447,-951 443.5,-961 450.5,-961"/>
</g>
<!-- b4 -->
<g id="node49" class="node">
<title>b4</title>
<polygon fill="none" stroke="black" points="602.5,-871 291.5,-871 291.5,-809 602.5,-809 602.5,-871"/>
<text text-anchor="start" x="299.5" y="-854.2" font-family="Times,serif" font-size="16.00">blocking_notifier_call_chain:</text>
<text text-anchor="start" x="299.5" y="-836.2" font-family="Times,serif" font-size="16.00">module_notify_list:MODULE_STATE_LIVE</text>
<text text-anchor="start" x="299.5" y="-818.2" font-family="Times,serif" font-size="16.00">给对模块加载感兴趣的单元发送通知信息.</text>
</g>
<!-- b3&#45;&gt;b4 -->
<g id="edge47" class="edge">
<title>b3:s&#45;&gt;b4:n</title>
<path fill="none" stroke="black" d="M447,-907C447,-895 447,-889.75 447,-881.12"/>
<polygon fill="black" stroke="black" points="450.5,-881 447,-871 443.5,-881 450.5,-881"/>
</g>
<!-- b5 -->
<g id="node50" class="node">
<title>b5</title>
<polygon fill="none" stroke="black" points="620,-773 274,-773 274,-729 620,-729 620,-773"/>
<text text-anchor="start" x="282" y="-756.2" font-family="Times,serif" font-size="16.00">kobject_uevent(&amp;mod&#45;&gt;mkobj.kobj,KOBJ_ADD):</text>
<text text-anchor="start" x="282" y="-738.2" font-family="Times,serif" font-size="16.00">通知用户空间程序，有模块加载.</text>
</g>
<!-- b4&#45;&gt;b5 -->
<g id="edge48" class="edge">
<title>b4:s&#45;&gt;b5:n</title>
<path fill="none" stroke="black" d="M447,-809C447,-797 447,-791.75 447,-783.12"/>
<polygon fill="black" stroke="black" points="450.5,-783 447,-773 443.5,-783 450.5,-783"/>
</g>
<!-- b6 -->
<g id="node51" class="node">
<title>b6</title>
<polygon fill="none" stroke="black" points="539,-693 355,-693 355,-649 539,-649 539,-693"/>
<text text-anchor="start" x="363" y="-676.2" font-family="Times,serif" font-size="16.00">async_synchronize_full():</text>
<text text-anchor="start" x="363" y="-658.2" font-family="Times,serif" font-size="16.00">同步</text>
</g>
<!-- b5&#45;&gt;b6 -->
<g id="edge49" class="edge">
<title>b5:s&#45;&gt;b6:n</title>
<path fill="none" stroke="black" d="M447,-729C447,-717 447,-711.75 447,-703.12"/>
<polygon fill="black" stroke="black" points="450.5,-703 447,-693 443.5,-703 450.5,-703"/>
</g>
<!-- b7 -->
<g id="node52" class="node">
<title>b7</title>
<polygon fill="none" stroke="black" points="612,-613 282,-613 282,-551 612,-551 612,-613"/>
<text text-anchor="start" x="290" y="-596.2" font-family="Times,serif" font-size="16.00">ftrace_free_mem(mod,mod&#45;&gt;init_layout.base,</text>
<text text-anchor="start" x="290" y="-578.2" font-family="Times,serif" font-size="16.00">mod&#45;&gt;init_layout.base + mod&#45;&gt;init_layout.size):</text>
<text text-anchor="start" x="290" y="-560.2" font-family="Times,serif" font-size="16.00">释放初始化部分内存</text>
</g>
<!-- b6&#45;&gt;b7 -->
<g id="edge50" class="edge">
<title>b6:s&#45;&gt;b7:n</title>
<path fill="none" stroke="black" d="M447,-649C447,-637 447,-631.75 447,-623.12"/>
<polygon fill="black" stroke="black" points="450.5,-623 447,-613 443.5,-623 450.5,-623"/>
</g>
<!-- b9 -->
<g id="node53" class="node">
<title>b9</title>
<polygon fill="none" stroke="black" points="530.5,-515 363.5,-515 363.5,-479 530.5,-479 530.5,-515"/>
<text text-anchor="start" x="371.5" y="-493.2" font-family="Times,serif" font-size="16.00">trim_init_extable(mod)</text>
</g>
<!-- b7&#45;&gt;b9 -->
<g id="edge51" class="edge">
<title>b7:s&#45;&gt;b9:n</title>
<path fill="none" stroke="black" d="M447,-551C447,-539 447,-533.75 447,-525.12"/>
<polygon fill="black" stroke="black" points="450.5,-525 447,-515 443.5,-525 450.5,-525"/>
</g>
<!-- b10 -->
<g id="node54" class="node">
<title>b10</title>
<polygon fill="none" stroke="black" points="648,-443 246,-443 246,-407 648,-407 648,-443"/>
<text text-anchor="middle" x="447" y="-421.2" font-family="Times,serif" font-size="16.00">rcu_assign_pointer(mod&#45;&gt;kallsyms,&amp;mod&#45;&gt;core_kallsyms)</text>
</g>
<!-- b9&#45;&gt;b10 -->
<g id="edge52" class="edge">
<title>b9:s&#45;&gt;b10:n</title>
<path fill="none" stroke="black" d="M447,-479C447,-467 447,-461.75 447,-453.12"/>
<polygon fill="black" stroke="black" points="450.5,-453 447,-443 443.5,-453 450.5,-453"/>
</g>
<!-- b11 -->
<g id="node55" class="node">
<title>b11</title>
<polygon fill="none" stroke="black" points="551.5,-371 342.5,-371 342.5,-335 551.5,-335 551.5,-371"/>
<text text-anchor="start" x="350.5" y="-349.2" font-family="Times,serif" font-size="16.00">module_enable_ro(mod,true);</text>
</g>
<!-- b10&#45;&gt;b11 -->
<g id="edge53" class="edge">
<title>b10:s&#45;&gt;b11:n</title>
<path fill="none" stroke="black" d="M447,-407C447,-395 447,-389.75 447,-381.12"/>
<polygon fill="black" stroke="black" points="450.5,-381 447,-371 443.5,-381 450.5,-381"/>
</g>
<!-- b12 -->
<g id="node56" class="node">
<title>b12</title>
<polygon fill="none" stroke="black" points="551,-299 343,-299 343,-263 551,-263 551,-299"/>
<text text-anchor="start" x="351" y="-277.2" font-family="Times,serif" font-size="16.00">mod_tree_remove_init(mod);</text>
</g>
<!-- b11&#45;&gt;b12 -->
<g id="edge54" class="edge">
<title>b11:s&#45;&gt;b12:n</title>
<path fill="none" stroke="black" d="M447,-335C447,-323 447,-317.75 447,-309.12"/>
<polygon fill="black" stroke="black" points="450.5,-309 447,-299 443.5,-309 450.5,-309"/>
</g>
<!-- b13 -->
<g id="node57" class="node">
<title>b13</title>
<polygon fill="none" stroke="black" points="561,-227 333,-227 333,-191 561,-191 561,-227"/>
<text text-anchor="start" x="341" y="-205.2" font-family="Times,serif" font-size="16.00">module_arch_freeing_init(mod);</text>
</g>
<!-- b12&#45;&gt;b13 -->
<g id="edge55" class="edge">
<title>b12:s&#45;&gt;b13:n</title>
<path fill="none" stroke="black" d="M447,-263C447,-251 447,-245.75 447,-237.12"/>
<polygon fill="black" stroke="black" points="450.5,-237 447,-227 443.5,-237 450.5,-237"/>
</g>
<!-- b14 -->
<g id="node58" class="node">
<title>b14</title>
<polygon fill="none" stroke="black" points="558.5,-155 335.5,-155 335.5,-119 558.5,-119 558.5,-155"/>
<text text-anchor="start" x="343.5" y="-133.2" font-family="Times,serif" font-size="16.00">schedule_work(&amp;init_free_wq);</text>
</g>
<!-- b13&#45;&gt;b14 -->
<g id="edge56" class="edge">
<title>b13:s&#45;&gt;b14:n</title>
<path fill="none" stroke="black" d="M447,-191C447,-179 447,-173.75 447,-165.12"/>
<polygon fill="black" stroke="black" points="450.5,-165 447,-155 443.5,-165 450.5,-165"/>
</g>
<!-- b15 -->
<g id="node59" class="node">
<title>b15</title>
<polygon fill="none" stroke="black" points="548.5,-83 345.5,-83 345.5,-47 548.5,-47 548.5,-83"/>
<text text-anchor="start" x="353.5" y="-61.2" font-family="Times,serif" font-size="16.00">wake_up_all(&amp;module_wq);</text>
</g>
<!-- b14&#45;&gt;b15 -->
<g id="edge57" class="edge">
<title>b14:s&#45;&gt;b15:n</title>
<path fill="none" stroke="black" d="M447,-119C447,-107 447,-101.75 447,-93.12"/>
<polygon fill="black" stroke="black" points="450.5,-93 447,-83 443.5,-93 450.5,-93"/>
</g>
</g>
</svg>
