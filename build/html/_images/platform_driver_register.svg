<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="1416pt" height="1367pt"
 viewBox="0.00 0.00 1416.00 1367.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1363)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1363 1412,-1363 1412,4 -4,4"/>
<text text-anchor="middle" x="704" y="-7.8" font-family="Times,serif" font-size="14.00">platform_driver_register流程</text>
<g id="clust1" class="cluster">
<title>cluster_0</title>
<polygon fill="none" stroke="black" points="8,-1132 8,-1351 447,-1351 447,-1132 8,-1132"/>
<text text-anchor="middle" x="227.5" y="-1335.8" font-family="Times,serif" font-size="14.00">__platform_driver_register(struct platform_driver *drv,struct module *owner</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_1</title>
<polygon fill="none" stroke="black" points="204,-902 204,-1124 488,-1124 488,-902 204,-902"/>
<text text-anchor="middle" x="346" y="-1108.8" font-family="Times,serif" font-size="14.00">driver_register：struct device_driver *drv</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_2</title>
<polygon fill="none" stroke="black" points="496,-175 496,-1049 972,-1049 972,-175 496,-175"/>
<text text-anchor="middle" x="734" y="-1033.8" font-family="Times,serif" font-size="14.00">bus_add_driver: struct device_driver *drv</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_3</title>
<polygon fill="none" stroke="black" points="980,-31 980,-396 1400,-396 1400,-31 980,-31"/>
<text text-anchor="middle" x="1190" y="-380.8" font-family="Times,serif" font-size="14.00">module_add_driver(struct module *mod,struct device_driver *drv)</text>
</g>
<!-- a0 -->
<g id="node1" class="node">
<title>a0</title>
<polygon fill="none" stroke="black" points="310,-1320 144,-1320 144,-1284 310,-1284 310,-1320"/>
<text text-anchor="middle" x="227" y="-1298.3" font-family="Times,serif" font-size="14.00">drv&#45;&gt;driver.owner = owner</text>
</g>
<!-- a1 -->
<g id="node2" class="node">
<title>a1</title>
<polygon fill="none" stroke="black" points="340.5,-1248 113.5,-1248 113.5,-1212 340.5,-1212 340.5,-1248"/>
<text text-anchor="middle" x="227" y="-1226.3" font-family="Times,serif" font-size="14.00">drv&#45;&gt;driver.bus = &amp;platorm_bus_type</text>
</g>
<!-- a0&#45;&gt;a1 -->
<g id="edge1" class="edge">
<title>a0:s&#45;&gt;a1:n</title>
<path fill="none" stroke="black" d="M227,-1284C227,-1284 227,-1268.86 227,-1258.22"/>
<polygon fill="black" stroke="black" points="230.5,-1258 227,-1248 223.5,-1258 230.5,-1258"/>
</g>
<!-- a2 -->
<g id="node3" class="node">
<title>a2</title>
<polygon fill="none" stroke="black" points="316.5,-1176 137.5,-1176 137.5,-1140 316.5,-1140 316.5,-1176"/>
<text text-anchor="middle" x="227" y="-1154.3" font-family="Times,serif" font-size="14.00">driver_register(&amp;drv&#45;&gt;driver)</text>
</g>
<!-- a1&#45;&gt;a2 -->
<g id="edge2" class="edge">
<title>a1:s&#45;&gt;a2:n</title>
<path fill="none" stroke="black" d="M227,-1212C227,-1212 227,-1196.86 227,-1186.22"/>
<polygon fill="black" stroke="black" points="230.5,-1186 227,-1176 223.5,-1186 230.5,-1186"/>
</g>
<!-- b0 -->
<g id="node4" class="node">
<title>b0</title>
<polygon fill="none" stroke="black" points="445,-1093 317,-1093 317,-1057 445,-1057 445,-1093"/>
<text text-anchor="middle" x="381" y="-1071.3" font-family="Times,serif" font-size="14.00">bus_add_driver(drv)</text>
</g>
<!-- a2&#45;&gt;b0 -->
<g id="edge5" class="edge">
<title>a2:e&#45;&gt;b0:w</title>
<path fill="none" stroke="black" d="M318,-1158C318,-1158 316,-1075 316,-1075"/>
</g>
<!-- b1 -->
<g id="node5" class="node">
<title>b1</title>
<polygon fill="none" stroke="black" points="467,-1018 251,-1018 251,-982 467,-982 467,-1018"/>
<text text-anchor="middle" x="359" y="-996.3" font-family="Times,serif" font-size="14.00">driver_add_groups(drv,drv&#45;&gt;groups)</text>
</g>
<!-- b0&#45;&gt;b1 -->
<g id="edge3" class="edge">
<title>b0:s&#45;&gt;b1:n</title>
<path fill="none" stroke="black" d="M381,-1057C381,-1057 370.6,-1039.04 364.1,-1027.81"/>
<polygon fill="black" stroke="black" points="367.04,-1025.9 359,-1019 360.98,-1029.41 367.04,-1025.9"/>
</g>
<!-- c0 -->
<g id="node7" class="node">
<title>c0</title>
<polygon fill="none" stroke="black" points="738.5,-1018 515.5,-1018 515.5,-982 738.5,-982 738.5,-1018"/>
<text text-anchor="middle" x="627" y="-996.3" font-family="Times,serif" font-size="14.00">struct driver_private *priv = kzalloc()</text>
</g>
<!-- b0&#45;&gt;c0 -->
<g id="edge17" class="edge">
<title>b0:e&#45;&gt;c0:w</title>
<path fill="none" stroke="black" d="M446,-1075C446,-1075 515,-1000 515,-1000"/>
</g>
<!-- b2 -->
<g id="node6" class="node">
<title>b2</title>
<polygon fill="none" stroke="black" points="479.5,-946 212.5,-946 212.5,-910 479.5,-910 479.5,-946"/>
<text text-anchor="middle" x="346" y="-924.3" font-family="Times,serif" font-size="14.00">kobject_uevent(&amp;drv&#45;&gt;p&#45;&gt;kobj,KOBJ_ADD)</text>
</g>
<!-- b1&#45;&gt;b2 -->
<g id="edge4" class="edge">
<title>b1:s&#45;&gt;b2:n</title>
<path fill="none" stroke="black" d="M359,-982C359,-982 353.27,-966.12 349.42,-955.46"/>
<polygon fill="black" stroke="black" points="352.69,-954.22 346,-946 346.1,-956.59 352.69,-954.22"/>
</g>
<!-- c1 -->
<g id="node8" class="node">
<title>c1</title>
<polygon fill="none" stroke="black" points="785.5,-946 516.5,-946 516.5,-910 785.5,-910 785.5,-946"/>
<text text-anchor="middle" x="651" y="-924.3" font-family="Times,serif" font-size="14.00">klist_init(&amp;priv&#45;&gt;klist_devices,NULL,NULL)</text>
</g>
<!-- c0&#45;&gt;c1 -->
<g id="edge6" class="edge">
<title>c0:s&#45;&gt;c1:n</title>
<path fill="none" stroke="black" d="M627,-982C627,-982 638.34,-964.98 645.43,-954.35"/>
<polygon fill="black" stroke="black" points="648.37,-956.26 651,-946 642.54,-952.38 648.37,-956.26"/>
</g>
<!-- c2 -->
<g id="node9" class="node">
<title>c2</title>
<polygon fill="none" stroke="black" points="721.5,-874 604.5,-874 604.5,-838 721.5,-838 721.5,-874"/>
<text text-anchor="middle" x="663" y="-852.3" font-family="Times,serif" font-size="14.00">priv&#45;&gt;driver = drv</text>
</g>
<!-- c1&#45;&gt;c2 -->
<g id="edge7" class="edge">
<title>c1:s&#45;&gt;c2:n</title>
<path fill="none" stroke="black" d="M651,-909C651,-909 656.17,-893.93 659.72,-883.56"/>
<polygon fill="black" stroke="black" points="663.07,-884.59 663,-874 656.45,-882.32 663.07,-884.59"/>
</g>
<!-- c3 -->
<g id="node10" class="node">
<title>c3</title>
<polygon fill="none" stroke="black" points="733.5,-802 638.5,-802 638.5,-766 733.5,-766 733.5,-802"/>
<text text-anchor="middle" x="686" y="-780.3" font-family="Times,serif" font-size="14.00">drv&#45;&gt;p = priv;</text>
</g>
<!-- c2&#45;&gt;c3 -->
<g id="edge8" class="edge">
<title>c2:s&#45;&gt;c3:n</title>
<path fill="none" stroke="black" d="M663,-838C663,-838 673.63,-821.37 680.43,-810.71"/>
<polygon fill="black" stroke="black" points="683.57,-812.31 686,-802 677.67,-808.54 683.57,-812.31"/>
</g>
<!-- c4 -->
<g id="node11" class="node">
<title>c4</title>
<polygon fill="none" stroke="black" points="857,-730 539,-730 539,-694 857,-694 857,-730"/>
<text text-anchor="middle" x="698" y="-708.3" font-family="Times,serif" font-size="14.00">priv&#45;&gt;kobj.kset = bus&#45;&gt;p&#45;&gt;divers_kset;这是从属关系</text>
</g>
<!-- c3&#45;&gt;c4 -->
<g id="edge9" class="edge">
<title>c3:s&#45;&gt;c4:n</title>
<path fill="none" stroke="black" d="M686,-766C686,-766 691.17,-750.5 694.72,-739.84"/>
<polygon fill="black" stroke="black" points="698.16,-740.59 698,-730 691.52,-738.38 698.16,-740.59"/>
</g>
<!-- c5 -->
<g id="node12" class="node">
<title>c5</title>
<polygon fill="none" stroke="black" points="873.5,-658 558.5,-658 558.5,-622 873.5,-622 873.5,-658"/>
<text text-anchor="middle" x="716" y="-636.3" font-family="Times,serif" font-size="14.00">kobject_init_and_add(&amp;priv&#45;&gt;kobj,&amp;driver_ktype,....)</text>
</g>
<!-- c4&#45;&gt;c5 -->
<g id="edge10" class="edge">
<title>c4:s&#45;&gt;c5:n</title>
<path fill="none" stroke="black" d="M698,-694C698,-694 706.13,-677.75 711.46,-667.08"/>
<polygon fill="black" stroke="black" points="714.66,-668.51 716,-658 708.4,-665.38 714.66,-668.51"/>
</g>
<!-- c6 -->
<g id="node13" class="node">
<title>c6</title>
<polygon fill="none" stroke="black" points="963.5,-586 504.5,-586 504.5,-550 963.5,-550 963.5,-586"/>
<text text-anchor="middle" x="734" y="-564.3" font-family="Times,serif" font-size="14.00">klist_add_tail(&amp;priv&#45;&gt;knode_bus,&amp;bus&#45;&gt;p&#45;&gt;klist_drivers):这么就挂到bus上了</text>
</g>
<!-- c5&#45;&gt;c6 -->
<g id="edge11" class="edge">
<title>c5:s&#45;&gt;c6:n</title>
<path fill="none" stroke="black" d="M716,-622C716,-622 724.13,-605.75 729.46,-595.08"/>
<polygon fill="black" stroke="black" points="732.66,-596.51 734,-586 726.4,-593.38 732.66,-596.51"/>
</g>
<!-- c7 -->
<g id="node14" class="node">
<title>c7</title>
<polygon fill="none" stroke="black" points="863.5,-514 654.5,-514 654.5,-476 863.5,-476 863.5,-514"/>
<text text-anchor="start" x="662.5" y="-498.8" font-family="Times,serif" font-size="14.00">if drv&#45;&gt;bus&#45;&gt;p&#45;&gt;drivers_autoprobe</text>
<text text-anchor="middle" x="759" y="-483.8" font-family="Times,serif" font-size="14.00">driver_attach(drv)</text>
</g>
<!-- c6&#45;&gt;c7 -->
<g id="edge12" class="edge">
<title>c6:s&#45;&gt;c7:n</title>
<path fill="none" stroke="black" d="M734,-550C734,-550 745.82,-532.98 753.2,-522.35"/>
<polygon fill="black" stroke="black" points="756.17,-524.21 759,-514 750.42,-520.22 756.17,-524.21"/>
</g>
<!-- c8 -->
<g id="node15" class="node">
<title>c8</title>
<polygon fill="none" stroke="black" points="919.5,-440 698.5,-440 698.5,-404 919.5,-404 919.5,-440"/>
<text text-anchor="middle" x="809" y="-418.3" font-family="Times,serif" font-size="14.00">module_add_driver(drv&#45;&gt;owner,drv);</text>
</g>
<!-- c7&#45;&gt;c8 -->
<g id="edge13" class="edge">
<title>c7:s&#45;&gt;c8:n</title>
<path fill="none" stroke="black" d="M759,-476C759,-476 786.54,-456.17 800.74,-445.94"/>
<polygon fill="black" stroke="black" points="802.93,-448.68 809,-440 798.84,-443 802.93,-448.68"/>
</g>
<!-- c9 -->
<g id="node16" class="node">
<title>c9</title>
<polygon fill="none" stroke="black" points="937.5,-365 680.5,-365 680.5,-329 937.5,-329 937.5,-365"/>
<text text-anchor="middle" x="809" y="-343.3" font-family="Times,serif" font-size="14.00">driver_create_file(drv,&amp;driver_attr_uevent);</text>
</g>
<!-- c8&#45;&gt;c9 -->
<g id="edge14" class="edge">
<title>c8:s&#45;&gt;c9:n</title>
<path fill="none" stroke="black" d="M809,-404C809,-404 809,-387.63 809,-376.38"/>
<polygon fill="black" stroke="black" points="812.5,-376 809,-366 805.5,-376 812.5,-376"/>
</g>
<!-- d0 -->
<g id="node19" class="node">
<title>d0</title>
<polygon fill="none" stroke="black" points="1270,-365 1004,-365 1004,-329 1270,-329 1270,-365"/>
<text text-anchor="middle" x="1137" y="-343.3" font-family="Times,serif" font-size="14.00">struct module_kobject *mk = &amp;mod&#45;&gt;mkobj</text>
</g>
<!-- c8&#45;&gt;d0 -->
<g id="edge22" class="edge">
<title>c8:e&#45;&gt;d0:w</title>
<path fill="none" stroke="black" d="M920,-422C920,-422 1003,-347 1003,-347"/>
</g>
<!-- c10 -->
<g id="node17" class="node">
<title>c10</title>
<polygon fill="none" stroke="black" points="930,-293 688,-293 688,-257 930,-257 930,-293"/>
<text text-anchor="middle" x="809" y="-271.3" font-family="Times,serif" font-size="14.00">driver_add_groups(drv,bus&#45;&gt;drv_groups)</text>
</g>
<!-- c9&#45;&gt;c10 -->
<g id="edge15" class="edge">
<title>c9:s&#45;&gt;c10:n</title>
<path fill="none" stroke="black" d="M809,-329C809,-329 809,-313.86 809,-303.22"/>
<polygon fill="black" stroke="black" points="812.5,-303 809,-293 805.5,-303 812.5,-303"/>
</g>
<!-- c11 -->
<g id="node18" class="node">
<title>c11</title>
<polygon fill="none" stroke="black" points="892.5,-221 725.5,-221 725.5,-183 892.5,-183 892.5,-221"/>
<text text-anchor="start" x="733.5" y="-205.8" font-family="Times,serif" font-size="14.00">if drv&#45;&gt;suppress_bind_attrs</text>
<text text-anchor="middle" x="809" y="-190.8" font-family="Times,serif" font-size="14.00"> add_bind_files(drv)</text>
</g>
<!-- c10&#45;&gt;c11 -->
<g id="edge16" class="edge">
<title>c10:s&#45;&gt;c11:n</title>
<path fill="none" stroke="black" d="M809,-257C809,-257 809,-241.86 809,-231.22"/>
<polygon fill="black" stroke="black" points="812.5,-231 809,-221 805.5,-231 812.5,-231"/>
</g>
<!-- d1 -->
<g id="node20" class="node">
<title>d1</title>
<polygon fill="none" stroke="black" points="1338,-293 1006,-293 1006,-257 1338,-257 1338,-293"/>
<text text-anchor="middle" x="1172" y="-271.3" font-family="Times,serif" font-size="14.00">sysfs_create_link(&amp;drv&#45;&gt;p&#45;&gt;kobj,&amp;mk&#45;&gt;kobj,&quot;module&quot;)</text>
</g>
<!-- d0&#45;&gt;d1 -->
<g id="edge18" class="edge">
<title>d0:s&#45;&gt;d1:n</title>
<path fill="none" stroke="black" d="M1137,-329C1137,-329 1154.69,-310.8 1164.92,-300.29"/>
<polygon fill="black" stroke="black" points="1167.54,-302.61 1172,-293 1162.52,-297.73 1167.54,-302.61"/>
</g>
<!-- d2 -->
<g id="node21" class="node">
<title>d2</title>
<polygon fill="none" stroke="black" points="1392,-220 988,-220 988,-184 1392,-184 1392,-220"/>
<text text-anchor="middle" x="1190" y="-198.3" font-family="Times,serif" font-size="14.00">driver_name = make_driver_name(drv):(drv&#45;&gt;bus&#45;&gt;name:drv&#45;&gt;name)</text>
</g>
<!-- d1&#45;&gt;d2 -->
<g id="edge19" class="edge">
<title>d1:s&#45;&gt;d2:n</title>
<path fill="none" stroke="black" d="M1172,-257C1172,-257 1180.13,-240.75 1185.46,-230.08"/>
<polygon fill="black" stroke="black" points="1188.66,-231.51 1190,-221 1182.4,-228.38 1188.66,-231.51"/>
</g>
<!-- d3 -->
<g id="node22" class="node">
<title>d3</title>
<polygon fill="none" stroke="black" points="1285,-147 1095,-147 1095,-111 1285,-111 1285,-147"/>
<text text-anchor="middle" x="1190" y="-125.3" font-family="Times,serif" font-size="14.00">module_create_drivers_dir(mk)</text>
</g>
<!-- d2&#45;&gt;d3 -->
<g id="edge20" class="edge">
<title>d2:s&#45;&gt;d3:n</title>
<path fill="none" stroke="black" d="M1190,-183C1190,-183 1190,-167.86 1190,-157.22"/>
<polygon fill="black" stroke="black" points="1193.5,-157 1190,-147 1186.5,-157 1193.5,-157"/>
</g>
<!-- d4 -->
<g id="node23" class="node">
<title>d4</title>
<polygon fill="none" stroke="black" points="1375.5,-75 1004.5,-75 1004.5,-39 1375.5,-39 1375.5,-75"/>
<text text-anchor="middle" x="1190" y="-53.3" font-family="Times,serif" font-size="14.00">sysfs_create_link(mk&#45;&gt;drivers_dir,&amp;drv&#45;&gt;p&#45;&gt;kobj,driver_name)</text>
</g>
<!-- d3&#45;&gt;d4 -->
<g id="edge21" class="edge">
<title>d3:s&#45;&gt;d4:n</title>
<path fill="none" stroke="black" d="M1190,-111C1190,-111 1190,-95.86 1190,-85.22"/>
<polygon fill="black" stroke="black" points="1193.5,-85 1190,-75 1186.5,-85 1193.5,-85"/>
</g>
</g>
</svg>
